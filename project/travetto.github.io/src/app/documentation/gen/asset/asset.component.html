<div class="documentation"><h1 id="asset" id="asset">Asset</h1>
<p>This module provides the framework for storing/retrieving assets. It also provides additional image functionality for on-the-fly resizing. </p>
<p>The asset module requires an <a class="source-link" href="https://github.com/travetto/travetto/tree/master/module/asset/src/service/source.ts" target="_blank" null><code class="inline">AssetSource</code></a> to provide functionality for reading and writing files. The <code class="inline">AssetSource</code> will need to be configured to be picked up by the <code class="inline">AssetService</code></p>
<app-section-header headerType="code">Registering Asset Source</app-section-header>
<pre><code class="language-typescript"><span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{{ '{' }}</span>
  @<span class="token meta">InjectableFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">static</span> <span class="token function">getSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token type">AssetSource</span> <span class="token punctuation">{{ '{' }}</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">CustomAssetSource</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{ '}' }}</span>
<span class="token punctuation">{{ '}' }}</span></code></pre><p>After that, both <a class="source-link" href="https://github.com/travetto/travetto/tree/master/module/asset/src/service/asset.ts" target="_blank" null><code class="inline">AssetService</code></a> and <a class="source-link" href="https://github.com/travetto/travetto/tree/master/module/asset/src/service/image.ts" target="_blank" null><code class="inline">ImageService</code></a> will rely upon the <a class="source-link" href="https://github.com/travetto/travetto/tree/master/module/asset/src/service/source.ts" target="_blank" null><code class="inline">AssetSource</code></a> to do their work.  Below you can see an example of storing and retrieving a userâ€™s profile image.  </p>
<app-section-header headerType="install">Primary</app-section-header>
<pre><code class="language-bash">$ <span class="token function">npm</span> <span class="token function">install</span> @travetto/asset</code></pre><p>You will need to select one of the available providers to serve as your <code class="inline">AssetSource</code>.</p>
<app-section-header headerType="install">Secondary</app-section-header>
<pre><code class="language-bash">$ <span class="token function">npm</span> <span class="token function">install</span> @travetto/asset-<span class="token punctuation">{{ '{' }}</span>provider<span class="token punctuation">{{ '}' }}</span></code></pre><h2 id="images">Images</h2>
<p>Storing of all assets uses the <a class="source-link" href="https://github.com/travetto/travetto/tree/master/module/asset/src/service/asset.ts" target="_blank" null><code class="inline">AssetService</code></a>, but retrieval can either be from <a class="source-link" href="https://github.com/travetto/travetto/tree/master/module/asset/src/service/asset.ts" target="_blank" null><code class="inline">AssetService</code></a> or <a class="source-link" href="https://github.com/travetto/travetto/tree/master/module/asset/src/service/image.ts" target="_blank" null><code class="inline">ImageService</code></a> depending on whether or not you want to perform image optimizations on retrieval. The <code class="inline">ImageService</code> users <a class="external-link" href="http://www.graphicsmagick.org" target="_blank" null><code class="inline">GraphicsMagick</code></a> for image transformation.  If the binary is not installed the framework will spin up a <a class="external-link" href="https://www.docker.com/community-edition" target="_blank" null><code class="inline">docker</code></a> container to provide needed functionality.</p>
<app-section-header headerType="code">Storing images</app-section-header>
<pre><code class="language-typescript">@<span class="token meta">Injectable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">class</span> <span class="token class-name">UserProfileService</span> <span class="token punctuation">{{ '{' }}</span>

  <span class="token keyword">constructor</span><span class="token punctuation">(</span>
    <span class="token parameter"><span class="token keyword">private</span> asset<span class="token punctuation">:</span> <span class="token type">AssetService</span><span class="token punctuation">,</span>
    <span class="token keyword">private</span> image<span class="token punctuation">:</span> <span class="token type">ImageService</span><span class="token punctuation">,</span>
    <span class="token keyword">private</span> model<span class="token punctuation">:</span> ModelService</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{{ '{' }}</span><span class="token punctuation">{{ '}' }}</span>

  <span class="token keyword">async</span> <span class="token function">saveProfileImage</span><span class="token punctuation">(</span><span class="token parameter">userId<span class="token punctuation">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> image<span class="token punctuation">:</span> Asset</span><span class="token punctuation">)</span> <span class="token punctuation">{{ '{' }}</span>
    <span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>asset<span class="token punctuation">.</span><span class="token function">store</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>model<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span><span class="token type">User</span><span class="token punctuation">,</span> userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    user<span class="token punctuation">.</span>profileImage <span class="token operator">=</span> path<span class="token punctuation">;</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>model<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span><span class="token type">User</span><span class="token punctuation">,</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{ '}' }}</span>

  <span class="token keyword">async</span> <span class="token function">getProfileImage</span><span class="token punctuation">(</span><span class="token parameter">userId<span class="token punctuation">:</span><span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{{ '{' }}</span>
    <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>model<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>image<span class="token punctuation">.</span><span class="token function">getImage</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>profileImage<span class="token punctuation">,</span> <span class="token punctuation">{{ '{' }}</span> w<span class="token punctuation">:</span> <span class="token number">100</span><span class="token punctuation">,</span> h<span class="token punctuation">:</span> <span class="token number">100</span> <span class="token punctuation">{{ '}' }}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{ '}' }}</span>
<span class="token punctuation">{{ '}' }}</span></code></pre><p>Additionally, the <code class="inline">ImageService</code> currently supports the ability to resize an image on the fly, while auto orienting.  </p>
</div>

      <app-asset-mongo></app-asset-mongo>

      <app-asset-s3></app-asset-s3>

      <app-asset-rest></app-asset-rest>
