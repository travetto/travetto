<!-- This file was generated by the framweork and should not be modified directly -->
<!-- Please modify https://github.com/travetto/travetto/tree/master/module/asset/README.ts and execute "npm run docs" to rebuild -->
<div class="documentation">
<h1>Asset
          <small>Modular library for storing and retrieving binary assets</small>

        </h1>

      <figure class="install">
      <figcaption class="install">Install @travetto/asset
      
      </figcaption>
      <pre><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> @travetto/asset</code></pre>     
      </figure>

The asset module requires an <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/master/module/asset/src/source.ts#L6">AssetSource</a> to provide functionality for reading and writing files. You will need to select one of the available providers to serve as your <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/master/module/asset/src/source.ts#L6">AssetSource</a>.

      <figure class="install">
      <figcaption class="install">provider
      
      </figcaption>
      <pre><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> @travetto/asset-<span class="token punctuation">{{'{'}}</span>provider<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

Reading of and writing assets uses the <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/master/module/asset/src/service.ts#L14">AssetService</a>.  Below you can see an example dealing with a user's profile image.

      <figure class="code">
      <figcaption class="code">User Profile Images
      <cite><a target="_blank" href="https://github.com/travetto/travetto/tree/master/module/asset/alt/image/src/user-profile.ts">Source</a></cite>
      </figcaption>
      <pre><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> ModelService <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/model'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> AssetService <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/asset/src/service'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> Asset <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/asset/src/types'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> User <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'../user'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserProfileService</span> <span class="token punctuation">{{'{'}}</span>

  <span class="token keyword">constructor</span><span class="token punctuation">(</span>
    <span class="token parameter"><span class="token keyword">public</span> asset<span class="token operator">:</span> AssetService<span class="token punctuation">,</span>
    <span class="token keyword">public</span> model<span class="token operator">:</span> ModelService</span>
  <span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span> <span class="token punctuation">{{'}'}}</span>

  <span class="token keyword">async</span> <span class="token function">saveProfileImage</span><span class="token punctuation">(</span><span class="token parameter">userId<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> image<span class="token operator">:</span> Asset</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
    <span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>asset<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span>image<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>model<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span>User<span class="token punctuation">,</span> userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    user<span class="token punctuation">.</span>profileImage <span class="token operator">=</span> path<span class="token punctuation">;</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>model<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>User<span class="token punctuation">,</span> user<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span>

  <span class="token keyword">async</span> <span class="token function">getProfileImage</span><span class="token punctuation">(</span><span class="token parameter">userId<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
    <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>model<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>asset<span class="token punctuation">.</span><span class="token function">read</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>profileImage<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span>
<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

<h2 id="naming-strategies">Naming Strategies</h2>

By default, the assets are stored by path, as specified in the <a target="_blank" class="source-link" href="./src/types.ts#L5">Asset</a> object.  This is standard, and expected, but some finer control may be desired.  In addition to standard naming, the module also supports naming by hash, to prevent duplicate storage of the same files with different hashes. This is generally useful when surfacing a lot of public (within the application) user-generated content.

The underlying contract for a <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/master/module/asset/src/naming.ts#L8">AssetNamingStrategy</a> looks like:

      <figure class="code">
      <figcaption class="code">Asset Naming Strategy
      <cite><a target="_blank" href="https://github.com/travetto/travetto/tree/master/module/asset/src/naming.ts#L8">Source</a></cite>
      </figcaption>
      <pre><code class="language-typescript"><span class="token keyword">export</span> <span class="token keyword">abstract</span> <span class="token keyword">class</span> <span class="token class-name">AssetNamingStrategy</span> <span class="token punctuation">{{'{'}}</span>
  <span class="token keyword">public</span> <span class="token keyword">readonly</span> prefix<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Produce a path for a given asset
   * @param Asset Get path from an asset
   */</span>
  <span class="token keyword">abstract</span> <span class="token function">getPath</span><span class="token punctuation">(</span>Asset<span class="token operator">:</span> Asset<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

By extending this, and making it <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/master/module/di/src/decorator.ts#L29">@Injectable</a>, the naming strategy will become the default for the system.  

<h2 id="advanced-usage">Advanced Usage</h2>

In addition to reading and writing, you can also retrieve information on the saved asset, including basic information, and additional meta data.  The structure of the <a target="_blank" class="source-link" href="./src/types.ts#L5">Asset</a> looks like:

      <figure class="code">
      <figcaption class="code">Asset Structure
      <cite><a target="_blank" href="https://github.com/travetto/travetto/tree/master/module/asset/src/types.ts">Source</a></cite>
      </figcaption>
      <pre><code class="language-typescript"><span class="token comment">/**
 * A retrieval/storable asset
 *
 * @concrete ./internal/types:AssetImpl
 */</span>
<span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">Asset</span> <span class="token punctuation">{{'{'}}</span>
  <span class="token comment">/**
   * Stream of the asset contents
   */</span>
  stream<span class="token operator">:</span> NodeJS<span class="token punctuation">.</span>ReadableStream<span class="token punctuation">;</span>
  <span class="token comment">/**
   * Size in bytes
   */</span>
  size<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Path within the remote store
   */</span>
  path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Mime type of the content
   */</span>
  contentType<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Supplemental information
   */</span>
  metadata<span class="token operator">:</span> <span class="token punctuation">{{'{'}}</span>
    <span class="token comment">/**
     * The filename of the asset
     */</span>
    name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * A readable title of the asset
     */</span>
    title<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * Hash of the file contents.  Different files with the same name, will have the same hash
     */</span>
    hash<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
    <span class="token comment">/**
     * Date of creation
     */</span>
    createdDate<span class="token operator">:</span> Date<span class="token punctuation">;</span>
    <span class="token comment">/**
     * Optional tags, can be used for access control
     */</span>
    tags<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span><span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

To get the asset information, you would call:

      <figure class="code">
      <figcaption class="code">Fetching Asset Info
      <cite><a target="_blank" href="https://github.com/travetto/travetto/tree/master/module/asset/alt/image/src/user-profile-tags.ts">Source</a></cite>
      </figcaption>
      <pre><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> UserProfileService <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'./user-profile'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserProfileTagService</span> <span class="token keyword">extends</span> <span class="token class-name">UserProfileService</span> <span class="token punctuation">{{'{'}}</span>
  <span class="token keyword">async</span> <span class="token function">checkImageGroup</span><span class="token punctuation">(</span><span class="token parameter">userId<span class="token operator">:</span> <span class="token builtin">string</span></span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
    <span class="token keyword">const</span> user <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>model<span class="token punctuation">.</span><span class="token function">getById</span><span class="token punctuation">(</span>userId<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> info <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>asset<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>profileImage<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// Check asset's tags for a specific group</span>
    <span class="token keyword">return</span> info<span class="token punctuation">.</span>metadata<span class="token operator">?.</span>tags<span class="token operator">?.</span><span class="token function">includes</span><span class="token punctuation">(</span>user<span class="token punctuation">.</span>group<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span>
<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

</div>