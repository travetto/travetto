<!-- This file was generated by the framweork and should not be modified directly -->
<!-- Please modify https://github.com/travetto/travetto/tree/master/module/asset-s3/DOCS.js and execute "npm run docs" to rebuild -->
<div class="documentation">
<h1>S3 Asset Source
          <small>AWS S3 backend for the travetto asset module</small>

        </h1>

      <figure class="install">
      <figcaption class="install">Install @travetto/asset-s3
      
      </figcaption>
      <pre><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> @travetto/asset-s3</code></pre>     
      </figure>

This provides a <a target="_blank" class="external-link" href="https://aws.amazon.com/documentation/s3/">s3</a> implementation of the <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/master/module/asset/src/source.ts#L6">AssetSource</a> which is a backend for the <a class="module-link" href="/docs/asset" title="Modular library for storing and retrieving binary assets">Asset</a> module.  

      <figure class="code">
      <figcaption class="code">S3 backend wiring
      <cite><a target="_blank" href="https://github.com/travetto/travetto/tree/master/module/asset-s3/alt/docs/src/config.ts">Source</a></cite>
      </figcaption>
      <pre><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> InjectableFactory <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/di'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> S3AssetSource<span class="token punctuation">,</span> S3AssetConfig <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/asset-s3'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">AppConfig</span> <span class="token punctuation">{{'{'}}</span>
  @<span class="token meta">InjectableFactory</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">static</span> <span class="token function">getSource</span><span class="token punctuation">(</span><span class="token parameter">cfg<span class="token operator">:</span> S3AssetConfig</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">S3AssetSource</span><span class="token punctuation">(</span>cfg<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span>
<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

There is a default configuration that you can easily use, with some sensible defaults. 
 

      <figure class="code">
      <figcaption class="code">S3 Configuration
      <cite><a target="_blank" href="https://github.com/travetto/travetto/tree/master/module/asset-s3/src/config.ts">Source</a></cite>
      </figcaption>
      <pre><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> fromIni <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@aws-sdk/credential-provider-ini'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> <span class="token constant">S3</span> <span class="token keyword">from</span> <span class="token string">'@aws-sdk/client-s3'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> EnvUtil <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/boot'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> Config <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/config'</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * S3 Support as an Asset Source
 */</span>
@<span class="token meta">Config</span><span class="token punctuation">(</span><span class="token string">'s3.asset'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">S3AssetConfig</span> <span class="token punctuation">{{'{'}}</span>
  region <span class="token operator">=</span> <span class="token string">'us-east-1'</span><span class="token punctuation">;</span> <span class="token comment">// AWS Region</span>
  <span class="token keyword">namespace</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span> <span class="token comment">// S3 Bucket folder</span>
  bucket <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span> <span class="token comment">// S3 bucket</span>

  accessKeyId <span class="token operator">=</span> EnvUtil<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'AWS_ACCESS_KEY_ID'</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token string">''</span><span class="token punctuation">;</span>
  secretAccessKey <span class="token operator">=</span> EnvUtil<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'AWS_SECRET_ACCESS_KEY'</span><span class="token punctuation">)</span> <span class="token operator">??</span> <span class="token string">''</span><span class="token punctuation">;</span>
  config<span class="token operator">:</span> <span class="token constant">S3</span><span class="token punctuation">.</span>S3ClientConfig<span class="token punctuation">;</span> <span class="token comment">// Additional s3 config</span>

  chunkSize <span class="token operator">=</span> <span class="token number">5</span> <span class="token operator">*</span> <span class="token number">2</span> <span class="token operator">**</span> <span class="token number">20</span><span class="token punctuation">;</span> <span class="token comment">// Chunk size in bytes</span>

  <span class="token comment">/**
   * Produces the s3 config from the provide details, post construction
   */</span>
  <span class="token keyword">async</span> <span class="token function">postConstruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>accessKeyId <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">this</span><span class="token punctuation">.</span>secretAccessKey<span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
      <span class="token keyword">const</span> creds <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fromIni</span><span class="token punctuation">(</span><span class="token punctuation">{{'{'}}</span> profile<span class="token operator">:</span> EnvUtil<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span><span class="token string">'AWS_PROFILE'</span><span class="token punctuation">)</span> <span class="token punctuation">{{'}'}}</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>accessKeyId <span class="token operator">=</span> creds<span class="token punctuation">.</span>accessKeyId<span class="token punctuation">;</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>secretAccessKey <span class="token operator">=</span> creds<span class="token punctuation">.</span>secretAccessKey<span class="token punctuation">;</span>
    <span class="token punctuation">{{'}'}}</span>

    <span class="token keyword">this</span><span class="token punctuation">.</span>config <span class="token operator">=</span> <span class="token punctuation">{{'{'}}</span>
      credentials<span class="token operator">:</span> <span class="token punctuation">{{'{'}}</span>
        accessKeyId<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>accessKeyId<span class="token punctuation">,</span>
        secretAccessKey<span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>secretAccessKey
      <span class="token punctuation">{{'}'}}</span>
    <span class="token punctuation">{{'}'}}</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span>
<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

Additionally, you can see that the class is registered with the <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/master/module/config/src/decorator.ts#L9">@Config</a> annotation, and so these values can be overridden using the standard <a class="module-link" href="/docs/config" title="Environment-aware config management using yaml files">Configuration</a> resolution paths. 

<p class="note"><strong>Note</strong> 
  Do not commit your <code class="item input">accessKeyId</code> or <code class="item input">secretAccessKey</code> values to your source repository, especially if it is public facing.  Not only is it a security risk, but Amazon will scan public repos, looking for keys, and if found will react swiftly.
</p>


</div>