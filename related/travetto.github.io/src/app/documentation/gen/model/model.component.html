<!-- This file was generated by @travetto/doc and should not be modified directly -->
<!-- Please modify https://github.com/travetto/travetto/tree/main/module/model/doc.ts and execute "npx trv doc" to rebuild -->
<div class="documentation">
<h1>Data Modeling Support
          <small>Datastore abstraction for core operations.</small>

        </h1>

      <figure class="install">
      <figcaption class="install">Install @travetto/model
      
      </figcaption>
      <pre><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> @travetto/model</code></pre>     
      </figure>

This module provides a set of contracts/interfaces to data model persistence, modification and retrieval.  This module builds heavily upon the <a class="module-link" routerLink="/docs/schema" title="Data type registry for runtime validation, reflection and binding. ">Schema</a>, which is used for data model validation.

<h2 id="contracts">Contracts</h2>

The module is mainly composed of contracts.  The contracts define the expected interface for various model patterns. The primary contracts are <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/model/src/service/basic.ts#L9">Basic</a>, <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/model/src/service/crud.ts#L11">CRUD</a>, <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/model/src/service/indexed.ts#L11">Indexed</a>, <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/model/src/service/expiry.ts#L11">Expiry</a>, <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/model/src/service/stream.ts#L1">Streaming</a> and <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/model/src/service/bulk.ts#L23">Bulk</a>.

<h3 id="basic"><a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/model/src/service/basic.ts#L9">Basic</a></h3>
All <a class="module-link" routerLink="/docs/model" title="Datastore abstraction for core operations.">Data Modeling Support</a> implementations, must honor the BasicCrud contract to be able to participate in the model ecosystem.  This contract represents the bare minimum for a model service.

      <figure class="code">
      <figcaption class="code">Basic Contract
      <cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/model/src/service/basic.ts#L9">Source</a></cite>
      </figcaption>
      <pre><code class="language-typescript"><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ModelBasicSupport<span class="token operator">&lt;</span><span class="token constant">C</span> <span class="token operator">=</span> <span class="token builtin">unknown</span><span class="token operator">></span></span> <span class="token punctuation">{{'{'}}</span>
  <span class="token comment">/**
   * Get underlying client
   */</span>
  <span class="token keyword">get</span> <span class="token function">client</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">C</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * Get by Id
   * @param id The identifier of the document to retrieve
   * @throws {{'{'}}NotFoundError{{'}'}} When an item is not found
   */</span>
  <span class="token keyword">get</span><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">ModelType</span><span class="token operator">></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * Create new item
   * @param item The document to create
   * @throws {{'{'}}ExistsError{{'}'}} When an item with the provdided id already exists
   */</span>
  <span class="token generic-function"><span class="token function">create</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> item<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * Delete an item
   * @param id The id of the document to delete
   * @throws {{'{'}}NotFoundError{{'}'}} When an item is not found
   */</span>
  <span class="token keyword">delete</span><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">ModelType</span><span class="token operator">></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

<h3 id="crud"><a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/model/src/service/crud.ts#L11">CRUD</a></h3>
The crud contract, builds upon the basic contract, and is built around the idea of simple data retrieval and storage, to create a foundation for other services that need only basic support.  The model extension in <a class="module-link" routerLink="/docs/auth" title="Authentication scaffolding for the travetto framework">Authentication</a>, is an example of a module that only needs create, read and delete, and so any implementation of <a class="module-link" routerLink="/docs/model" title="Datastore abstraction for core operations.">Data Modeling Support</a> that honors this contract, can be used with the <a class="module-link" routerLink="/docs/auth" title="Authentication scaffolding for the travetto framework">Authentication</a> model extension.

      <figure class="code">
      <figcaption class="code">Crud Contract
      <cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/model/src/service/crud.ts#L11">Source</a></cite>
      </figcaption>
      <pre><code class="language-typescript"><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ModelCrudSupport</span> <span class="token keyword">extends</span> <span class="token class-name">ModelBasicSupport</span> <span class="token punctuation">{{'{'}}</span>

  <span class="token comment">/**
   * Generate a uuid
   * @param value The optional value to generate a uuid around.  Passing the same value multiple times produces the same output.
   */</span>
  <span class="token function">uuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * Update an item
   * @param item The document to update.
   * @throws {{'{'}}NotFoundError{{'}'}} When an item is not found
   */</span>
  <span class="token generic-function"><span class="token function">update</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> item<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * Create or update an item
   * @param item The document to upsert
   * @param view The schema view to validate against
   */</span>
  <span class="token generic-function"><span class="token function">upsert</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> item<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * Update Partial
   * @param id The document identifier to update
   * @param item The document to partially update.
   * @param view The schema view to validate against
   * @throws {{'{'}}NotFoundError{{'}'}} When an item is not found
   */</span>
  <span class="token generic-function"><span class="token function">updatePartial</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> item<span class="token operator">:</span> Partial<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span> <span class="token operator">&amp;</span> <span class="token punctuation">{{'{'}}</span> id<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{{'}'}}</span><span class="token punctuation">,</span> view<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * List all items
   */</span>
  <span class="token generic-function"><span class="token function">list</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token operator">:</span> AsyncIterable<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

<h3 id="indexed"><a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/model/src/service/indexed.ts#L11">Indexed</a></h3>
Additionally, an implementation may support the ability for basic indexed queries. This is not the full featured query support of <a class="module-link" routerLink="/docs/model-query" title="Datastore abstraction for advanced query support.">Data Model Querying</a>, but
allowing for indexed lookups.  This does not support listing by index, but may be added at a later date.  

      <figure class="code">
      <figcaption class="code">Indexed Contract
      <cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/model/src/service/indexed.ts#L11">Source</a></cite>
      </figcaption>
      <pre><code class="language-typescript"><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ModelIndexedSupport</span> <span class="token keyword">extends</span> <span class="token class-name">ModelBasicSupport</span> <span class="token punctuation">{{'{'}}</span>
  <span class="token comment">/**
   * Get entity by index as defined by fields of idx and the body fields
   * @param cls The type to search by
   * @param idx The index name to search against
   * @param body The payload of fields needed to search
   */</span>
  <span class="token generic-function"><span class="token function">getByIndex</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> idx<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> body<span class="token operator">:</span> Partial<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * Delete entity by index as defined by fields of idx and the body fields
   * @param cls The type to search by
   * @param idx The index name to search against
   * @param body The payload of fields needed to search
   */</span>
  <span class="token generic-function"><span class="token function">deleteByIndex</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> idx<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> body<span class="token operator">:</span> Partial<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * List entity by rangeable index as defined by fields of idx and the body fields
   * @param cls The type to search by
   * @param idx The index name to search against
   * @param body The payload of fields needed to search
   */</span>
  <span class="token generic-function"><span class="token function">listByIndex</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> idx<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> body<span class="token operator">?</span><span class="token operator">:</span> Partial<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token operator">:</span> AsyncIterable<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

<h3 id="expiry"><a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/model/src/service/expiry.ts#L11">Expiry</a></h3>

Certain implementations will also provide support for automatic expiry of data at runtime.  This is extremely useful for temporary data as, and is used in the <a class="module-link" routerLink="/docs/cache" title="Caching functionality with decorators for declarative use.">Caching</a> module for expiring data accordingly.

      <figure class="code">
      <figcaption class="code">Expiry Contract
      <cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/model/src/service/expiry.ts#L11">Source</a></cite>
      </figcaption>
      <pre><code class="language-typescript"><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ModelExpirySupport</span> <span class="token keyword">extends</span> <span class="token class-name">ModelCrudSupport</span> <span class="token punctuation">{{'{'}}</span>
  <span class="token comment">/**
   * Delete all expired by class
   *
   * @returns Returns the number of documents expired
   */</span>
  <span class="token generic-function"><span class="token function">deleteExpired</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

<h3 id="streaming"><a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/model/src/service/stream.ts#L1">Streaming</a></h3>

Some implementations also allow for the ability to read/write binary data as a stream.  Given that all implementations can store <a target="_blank" class="external-link" href="https://en.wikipedia.org/wiki/Base64">Base64</a> encoded data, the key differentiator here, is native support for streaming data, as well as being able to store binary data of significant sizes.  This pattern is currently used by <a class="module-link" routerLink="/docs/asset" title="Modular library for storing and retrieving binary assets">Asset</a> for reading and writing asset data.

      <figure class="code">
      <figcaption class="code">Stream Contract
      <cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/model/src/service/stream.ts#L25">Source</a></cite>
      </figcaption>
      <pre><code class="language-typescript"><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ModelStreamSupport</span> <span class="token punctuation">{{'{'}}</span>

  <span class="token comment">/**
   * Upsert stream to storage
   * @param location The location of the stream
   * @param input The actual stream to write
   * @param meta The stream metadata
   */</span>
  <span class="token function">upsertStream</span><span class="token punctuation">(</span>location<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> input<span class="token operator">:</span> NodeJS<span class="token punctuation">.</span>ReadableStream<span class="token punctuation">,</span> meta<span class="token operator">:</span> StreamMeta<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * Get stream from asset store
   * @param location The location of the stream
   */</span>
  <span class="token function">getStream</span><span class="token punctuation">(</span>location<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>NodeJS<span class="token punctuation">.</span>ReadableStream<span class="token operator">></span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * Get metadata for stream
   * @param location The location of the stream
   */</span>
  <span class="token function">describeStream</span><span class="token punctuation">(</span>location<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>StreamMeta<span class="token operator">></span><span class="token punctuation">;</span>

  <span class="token comment">/**
   * Delete stream by location
   * @param location The location of the stream
   */</span>
  <span class="token function">deleteStream</span><span class="token punctuation">(</span>location<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

<h3 id="bulk"><a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/model/src/service/bulk.ts#L23">Bulk</a></h3>

Finally, there is support for bulk operations.  This is not to simply imply issuing many commands at in parallel, but implementation support for an atomic/bulk operation.  This should allow for higher throughput on data ingest, and potentially for atomic support on transactions.  

      <figure class="code">
      <figcaption class="code">Bulk Contract
      <cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/model/src/service/bulk.ts#L75">Source</a></cite>
      </figcaption>
      <pre><code class="language-typescript"><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ModelBulkSupport</span> <span class="token keyword">extends</span> <span class="token class-name">ModelCrudSupport</span> <span class="token punctuation">{{'{'}}</span>
  <span class="token generic-function"><span class="token function">processBulk</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> operations<span class="token operator">:</span> BulkOp<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>BulkResponse<span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

<h2 id="declaration">Declaration</h2>
Models are declared via the <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/model/src/registry/decorator.ts#L13">@Model</a> decorator, which allows the system to know that this is a class that is compatible with the module.  The only requirement for a model is the <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/model/src/types/model.ts#L4">ModelType</a>

      <figure class="code">
      <figcaption class="code">ModelType
      <cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/model/src/types/model.ts#L4">Source</a></cite>
      </figcaption>
      <pre><code class="language-typescript"><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ModelType</span> <span class="token punctuation">{{'{'}}</span>
  <span class="token comment">/**
   * Unique identifier.
   *
   * If not provided, will be computed on create
   */</span>
  id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Type of model to save
   */</span>
  <span class="token keyword">type</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Run before saving
   */</span>
  prePersist<span class="token operator">?</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Run after loading
   */</span>
  postLoad<span class="token operator">?</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token operator">|</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

All fields are optional, but the <code class="item field">id</code> and <code class="item field">type</code> are important as those field types are unable to be changed.  This may make using existing data models impossible if types other than strings are required.  Additionally, the type field, is intended to record the base model type and cannot be remapped. This is important to support polymorphism, not only in <a class="module-link" routerLink="/docs/model" title="Datastore abstraction for core operations.">Data Modeling Support</a>, but also in <a class="module-link" routerLink="/docs/schema" title="Data type registry for runtime validation, reflection and binding. ">Schema</a>.

<h2 id="implementations">Implementations</h2>

<table>
<thead>
<tr><th>Service</th><th>Basic</th><th>CRUD</th><th>Indexed</th><th>Expiry</th><th>Stream</th><th>Bulk</th></tr>
</thead>
<tbody>
<tr><td><a class="module-link" routerLink="/docs/model-dynamodb" title="DynamoDB backing for the travetto model module.">DynamoDB Model Support</a></td><td>X</td><td>X</td><td>X</td><td>X</td><td> </td><td> </td></tr>
<tr><td><a class="module-link" routerLink="/docs/model-elasticsearch" title="Elasticsearch backing for the travetto model module, with real-time modeling support for Elasticsearch mappings.">Elasticsearch Model Source</a></td><td>X</td><td>X</td><td>X</td><td>X</td><td> </td><td>X</td></tr>
<tr><td><a class="module-link" routerLink="/docs/model-firestore" title="Firestore backing for the travetto model module.">Firestore Model Support</a></td><td>X</td><td>X</td><td>X</td><td> </td><td> </td><td> </td></tr>
<tr><td><a class="module-link" routerLink="/docs/model-mongo" title="Mongo backing for the travetto model module.">MongoDB Model Support</a></td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td></tr>
<tr><td><a class="module-link" routerLink="/docs/model-redis" title="Redis backing for the travetto model module.">Redis Model Support</a></td><td>X</td><td>X</td><td>X</td><td>X</td><td> </td><td></td></tr>
<tr><td><a class="module-link" routerLink="/docs/model-s3" title="S3 backing for the travetto model module.">S3 Model Support</a></td><td>X</td><td>X</td><td> </td><td>X</td><td>X</td><td> </td></tr>
<tr><td><a class="module-link" routerLink="/docs/model-sql" title="SQL backing for the travetto model module, with real-time modeling support for SQL schemas.">SQL Model Service</a></td><td>X</td><td>X</td><td>X</td><td>X</td><td> </td><td>X</td></tr>
<tr><td><a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/model/src/provider/memory.ts#L49">MemoryModelService</a></td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td><td>X</td></tr>
<tr><td><a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/model/src/provider/file.ts#L46">FileModelService</a></td><td>X</td><td>X</td><td> </td><td>X</td><td>X</td><td>X</td></tr>
</tbody>
</table>

<h2 id="custom-model-service">Custom Model Service</h2>
In addition to the provided contracts, the module also provides common utilities and shared test suites.  The common utilities are useful for
repetitive functionality, that is unable to be shared due to not relying upon inheritance (this was an intentional design decision).  This allows for all the <a class="module-link" routerLink="/docs/model" title="Datastore abstraction for core operations.">Data Modeling Support</a> implementations to completely own the functionality and also to be able to provide additional/unique functionality that goes beyond the interface.

      <figure class="code">
      <figcaption class="code">Memory Service
      <cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/model/src/provider/memory.ts">Source</a></cite>
      </figcaption>
      <pre><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> StreamUtil <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/boot'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> Util<span class="token punctuation">,</span> Class<span class="token punctuation">,</span> TimeSpan <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/base'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> Injectable <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/di'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> Config <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/config'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> ModelCrudSupport <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'../service/crud'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> ModelStreamSupport<span class="token punctuation">,</span> StreamMeta <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'../service/stream'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> ModelType <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'../types/model'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> ModelExpirySupport <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'../service/expiry'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> ModelRegistry <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'../registry/model'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> ModelStorageSupport <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'../service/storage'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> ModelCrudUtil <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'../internal/service/crud'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> ModelExpiryUtil <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'../internal/service/expiry'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> NotFoundError <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'../error/not-found'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> ExistsError <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'../error/exists'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> ModelIndexedSupport <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'../service/indexed'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> ModelIndexedUtil <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'../internal/service/indexed'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> ModelStorageUtil <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'../internal/service/storage'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> StreamModel<span class="token punctuation">,</span> <span class="token constant">STREAMS</span> <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'../internal/service/stream'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> IndexConfig <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'../registry/types'</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token constant">STREAM_META</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${{'{'}}</span><span class="token constant">STREAMS</span><span class="token interpolation-punctuation punctuation">{{'}'}}</span></span><span class="token string">_meta</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
@<span class="token meta">Config</span><span class="token punctuation">(</span><span class="token string">'model.memory'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MemoryModelConfig</span> <span class="token punctuation">{{'{'}}</span>
  autoCreate<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  <span class="token keyword">namespace</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  cullRate<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">|</span> TimeSpan<span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span>
<span class="token keyword">function</span> <span class="token generic-function"><span class="token function">indexName</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> idx<span class="token operator">:</span> IndexConfig<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span> <span class="token operator">|</span> <span class="token builtin">string</span><span class="token punctuation">,</span> suffix<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
  <span class="token keyword">return</span> <span class="token punctuation">[</span>cls<span class="token punctuation">.</span>áš•id<span class="token punctuation">,</span> <span class="token keyword">typeof</span> idx <span class="token operator">===</span> <span class="token string">'string'</span> <span class="token operator">?</span> idx <span class="token operator">:</span> idx<span class="token punctuation">.</span>name<span class="token punctuation">,</span> suffix<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span>x <span class="token operator">=></span> <span class="token operator">!</span><span class="token operator">!</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">':'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span>
<span class="token keyword">function</span> <span class="token function">getFirstId</span><span class="token punctuation">(</span>data<span class="token operator">:</span> Map<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">unknown</span><span class="token operator">></span> <span class="token operator">|</span> Set<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">></span><span class="token punctuation">,</span> value<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
  <span class="token keyword">let</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>data <span class="token keyword">instanceof</span> <span class="token class-name">Set</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
    id <span class="token operator">=</span> data<span class="token punctuation">.</span><span class="token function">values</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>value <span class="token keyword">as</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span> <span class="token keyword">else</span> <span class="token punctuation">{{'{'}}</span>
    id <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token operator">...</span>data<span class="token punctuation">.</span><span class="token function">entries</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">[</span>k<span class="token punctuation">,</span> v<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=></span> v <span class="token operator">===</span> value<span class="token punctuation">)</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span>
  <span class="token keyword">return</span> id<span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span>
<span class="token comment">/**
 * Standard in-memory support
 */</span>
@<span class="token meta">Injectable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MemoryModelService</span> <span class="token keyword">implements</span> <span class="token class-name">ModelCrudSupport</span><span class="token punctuation">,</span> ModelStreamSupport<span class="token punctuation">,</span> ModelExpirySupport<span class="token punctuation">,</span> ModelStorageSupport<span class="token punctuation">,</span> ModelIndexedSupport <span class="token punctuation">{{'{'}}</span>
    sorted<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Map<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> Map<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> Map<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token builtin">number</span><span class="token operator">>>></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    unsorted<span class="token operator">:</span> <span class="token keyword">new</span> <span class="token class-name">Map<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> Map<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> Set<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token operator">>>></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">{{'}'}}</span><span class="token punctuation">;</span>
  <span class="token keyword">get</span> <span class="token function">client</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span> <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>#store<span class="token punctuation">;</span> <span class="token punctuation">{{'}'}}</span>
  <span class="token keyword">async</span> <span class="token function">postConstruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
  <span class="token comment">// CRUD Support</span>
  <span class="token function">uuid</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
  <span class="token keyword">async</span> <span class="token keyword">get</span><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">ModelType</span><span class="token operator">></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
  <span class="token keyword">async</span> <span class="token generic-function"><span class="token function">create</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> item<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
  <span class="token keyword">async</span> <span class="token generic-function"><span class="token function">update</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> item<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
  <span class="token keyword">async</span> <span class="token generic-function"><span class="token function">upsert</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> item<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
  <span class="token keyword">async</span> <span class="token generic-function"><span class="token function">updatePartial</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> item<span class="token operator">:</span> Partial<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span> <span class="token operator">&amp;</span> <span class="token punctuation">{{'{'}}</span> id<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token punctuation">{{'}'}}</span><span class="token punctuation">,</span> view<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
  <span class="token keyword">async</span> <span class="token keyword">delete</span><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token class-name">ModelType</span><span class="token operator">></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
  <span class="token keyword">async</span> <span class="token operator">*</span> <span class="token generic-function"><span class="token function">list</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
  <span class="token comment">// Stream Support</span>
  <span class="token keyword">async</span> <span class="token function">upsertStream</span><span class="token punctuation">(</span>location<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> input<span class="token operator">:</span> NodeJS<span class="token punctuation">.</span>ReadableStream<span class="token punctuation">,</span> meta<span class="token operator">:</span> StreamMeta<span class="token punctuation">)</span> <span class="token punctuation">;</span>
  <span class="token keyword">async</span> <span class="token function">getStream</span><span class="token punctuation">(</span>location<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
  <span class="token keyword">async</span> <span class="token function">describeStream</span><span class="token punctuation">(</span>location<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
  <span class="token keyword">async</span> <span class="token function">deleteStream</span><span class="token punctuation">(</span>location<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
  <span class="token comment">// Expiry Support</span>
  <span class="token keyword">async</span> <span class="token generic-function"><span class="token function">deleteExpired</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
  <span class="token comment">// Storage Support</span>
  <span class="token keyword">async</span> <span class="token function">createStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
  <span class="token keyword">async</span> <span class="token function">deleteStorage</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
  <span class="token keyword">async</span> <span class="token generic-function"><span class="token function">createModel</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
  <span class="token keyword">async</span> <span class="token generic-function"><span class="token function">truncateModel</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
  <span class="token comment">// Indexed</span>
  <span class="token keyword">async</span> <span class="token generic-function"><span class="token function">getByIndex</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> idx<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> body<span class="token operator">:</span> Partial<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span> <span class="token punctuation">;</span>
  <span class="token keyword">async</span> <span class="token generic-function"><span class="token function">deleteByIndex</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> idx<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> body<span class="token operator">:</span> Partial<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">;</span>
  <span class="token keyword">async</span> <span class="token operator">*</span> <span class="token generic-function"><span class="token function">listByIndex</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> idx<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> body<span class="token operator">?</span><span class="token operator">:</span> Partial<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token operator">:</span> AsyncGenerator<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span> <span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

To enforce that these contracts are honored, the module provides shared test suites to allow for custom implementations to ensure they are adhering to the contract's expected behavior.

      <figure class="code">
      <figcaption class="code">Memory Service Test Configuration
      <cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/model/test/memory.ts">Source</a></cite>
      </figcaption>
      <pre><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> Suite <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/test'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> MemoryModelConfig<span class="token punctuation">,</span> MemoryModelService <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'../src/provider/memory'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> ModelCrudSuite <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'../test-support/crud'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> ModelExpirySuite <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'../test-support/expiry'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> ModelStreamSuite <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'../test-support/stream'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> ModelIndexedSuite <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'../test-support/indexed'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> ModelBasicSuite <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'../test-support/basic'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> ModelPolymorphismSuite <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'../test-support/polymorphism'</span><span class="token punctuation">;</span>

@<span class="token meta">Suite</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MemoryBasicSuite</span> <span class="token keyword">extends</span> <span class="token class-name">ModelBasicSuite</span> <span class="token punctuation">{{'{'}}</span>
  serviceClass <span class="token operator">=</span> MemoryModelService<span class="token punctuation">;</span>
  configClass <span class="token operator">=</span> MemoryModelConfig<span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span>

@<span class="token meta">Suite</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MemoryCrudSuite</span> <span class="token keyword">extends</span> <span class="token class-name">ModelCrudSuite</span> <span class="token punctuation">{{'{'}}</span>
  serviceClass <span class="token operator">=</span> MemoryModelService<span class="token punctuation">;</span>
  configClass <span class="token operator">=</span> MemoryModelConfig<span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span>

@<span class="token meta">Suite</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MemoryStreamSuite</span> <span class="token keyword">extends</span> <span class="token class-name">ModelStreamSuite</span> <span class="token punctuation">{{'{'}}</span>
  serviceClass <span class="token operator">=</span> MemoryModelService<span class="token punctuation">;</span>
  configClass <span class="token operator">=</span> MemoryModelConfig<span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span>

@<span class="token meta">Suite</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MemoryExpirySuite</span> <span class="token keyword">extends</span> <span class="token class-name">ModelExpirySuite</span> <span class="token punctuation">{{'{'}}</span>
  serviceClass <span class="token operator">=</span> MemoryModelService<span class="token punctuation">;</span>
  configClass <span class="token operator">=</span> MemoryModelConfig<span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span>

@<span class="token meta">Suite</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MemoryIndexedSuite</span> <span class="token keyword">extends</span> <span class="token class-name">ModelIndexedSuite</span> <span class="token punctuation">{{'{'}}</span>
  serviceClass <span class="token operator">=</span> MemoryModelService<span class="token punctuation">;</span>
  configClass <span class="token operator">=</span> MemoryModelConfig<span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span>

@<span class="token meta">Suite</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MemoryPolymorphicSuite</span> <span class="token keyword">extends</span> <span class="token class-name">ModelPolymorphismSuite</span> <span class="token punctuation">{{'{'}}</span>
  serviceClass <span class="token operator">=</span> MemoryModelService<span class="token punctuation">;</span>
  configClass <span class="token operator">=</span> MemoryModelConfig<span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

<h2 id="cli-model-export">CLI - model:export</h2>

The module provides the ability to generate an export of the model structure from all the various <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/model/src/registry/decorator.ts#L13">@Model</a>s within the application.  This is useful for being able to generate the appropriate files to manually create the data schemas in production.

      <figure class="terminal">
      <figcaption class="terminal">Running model export
      
      </figcaption>
      <pre><code class="language-bash">$ trv model:export --help

Usage:  model:export <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token punctuation">[</span>provider<span class="token punctuation">]</span> <span class="token punctuation">[</span>models<span class="token punctuation">..</span>.<span class="token punctuation">]</span>

Options:
  -e, --env <span class="token operator">&lt;</span>env<span class="token operator">></span>  Application environment
  -h, --help       display <span class="token builtin class-name">help</span> <span class="token keyword">for</span> <span class="token builtin class-name">command</span></code></pre>     
      </figure>

<h2 id="cli-model-install">CLI - model:install</h2>

The module provides the ability to install all the various <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/model/src/registry/decorator.ts#L13">@Model</a>s within the application given the current configuration being targetted.  This is useful for being able to prepare the datastore manually.

      <figure class="terminal">
      <figcaption class="terminal">Running model install
      
      </figcaption>
      <pre><code class="language-bash">$ trv model:install --help

Usage:  model:install <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token punctuation">[</span>provider<span class="token punctuation">]</span> <span class="token punctuation">[</span>models<span class="token punctuation">..</span>.<span class="token punctuation">]</span>

Options:
  -e, --env <span class="token operator">&lt;</span>env<span class="token operator">></span>  Application environment
  -h, --help       display <span class="token builtin class-name">help</span> <span class="token keyword">for</span> <span class="token builtin class-name">command</span></code></pre>     
      </figure>
</div>
