<!-- This file was generated by @travetto/doc and should not be modified directly -->
<!-- Please modify https://github.com/travetto/travetto/tree/main/module/model-query/doc.ts and execute "npx trv doc" to rebuild -->
<div class="documentation">
<h1>Data Model Querying
          <small>Datastore abstraction for advanced query support.</small>

        </h1>

      <figure class="install">
      <figcaption class="install">Install @travetto/model-query
      
      </figcaption>
      <pre><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> @travetto/model-query</code></pre>     
      </figure>

This module provides an enhanced query contract for <a class="module-link" routerLink="/docs/model" title="Datastore abstraction for core operations.">Data Modeling Support</a> implementations.  This contract has been externalized due to it being more complex than many implemenations can natively support.  In addition to the contract, this module provides support for textual query language that can be checked and parsed into the proper query structure.

<h2 id="contracts">Contracts</h2>

<h3 id="query"><a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/model-query/src/service/query.ts#L10">Query</a></h3>
This contract provides the ability to apply the query support to return one or many items, as well as providing counts against a specific query.

      <figure class="code">
      <figcaption class="code">Query
      <cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/model-query/src/service/query.ts#L10">Source</a></cite>
      </figcaption>
      <pre><code class="language-typescript"><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ModelQuerySupport</span> <span class="token punctuation">{{'{'}}</span>
  <span class="token comment">/**
   * Executes a query against the model space
   * @param cls The model class
   * @param query The query to execute
   */</span>
  <span class="token generic-function"><span class="token function">query</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> query<span class="token operator">:</span> PageableModelQuery<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Find one by query, fail if not found
   * @param cls The model class
   * @param query The query to search for
   * @param failOnMany Should the query fail on more than one result found
   */</span>
  <span class="token generic-function"><span class="token function">queryOne</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> query<span class="token operator">:</span> ModelQuery<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> failOnMany<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Find the count of matching documents by query.
   * @param cls The model class
   * @param query The query to count for
   */</span>
  <span class="token generic-function"><span class="token function">queryCount</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> query<span class="token operator">:</span> ModelQuery<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

<h3 id="query-crud"><a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/model-query/src/service/crud.ts#L11">Query Crud</a></h3>
Reinforcing the complexity provided in these contracts, the <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/model-query/src/service/crud.ts#L11">Query Crud</a> contract allows for bulk update/deletion by query.  This requires the underlying implentation to support these operations.

      <figure class="code">
      <figcaption class="code">Query Crud
      <cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/model-query/src/service/crud.ts#L11">Source</a></cite>
      </figcaption>
      <pre><code class="language-typescript"><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ModelQueryCrudSupport</span> <span class="token keyword">extends</span> <span class="token class-name">ModelCrudSupport</span><span class="token punctuation">,</span> ModelQuerySupport <span class="token punctuation">{{'{'}}</span>
  <span class="token comment">/**
   * Update/replace all with partial data, by query
   * @param cls The model class
   * @param query The query to search for
   * @param data The partial data
   */</span>
  <span class="token generic-function"><span class="token function">updateByQuery</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> query<span class="token operator">:</span> ModelQuery<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> data<span class="token operator">:</span> Partial<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Delete all by query
   * @param cls The model class
   * @param query Query to search for deletable elements
   */</span>
  <span class="token generic-function"><span class="token function">deleteByQuery</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> query<span class="token operator">:</span> ModelQuery<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">number</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

<h3 id="facet"><a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/model-query/src/service/facet.ts#L12">Facet</a></h3>
With the complex nature of the query support, the ability to find counts by groups is a common and desirable pattern. This contract allows for faceting on a given field, with query filtering.

      <figure class="code">
      <figcaption class="code">Facet
      <cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/model-query/src/service/facet.ts#L12">Source</a></cite>
      </figcaption>
      <pre><code class="language-typescript"><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ModelQueryFacetSupport</span> <span class="token keyword">extends</span> <span class="token class-name">ModelQuerySupport</span> <span class="token punctuation">{{'{'}}</span>
  <span class="token comment">/**
   * Facet a given class on a specific field, limited by an optional query
   * @param cls The model class to facet on
   * @param field The field to facet on
   * @param query Additional query filtering
   */</span>
  <span class="token generic-function"><span class="token function">facet</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> field<span class="token operator">:</span> ValidStringFields<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> query<span class="token operator">?</span><span class="token operator">:</span> ModelQuery<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token punctuation">{{'{'}}</span> key<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> count<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">{{'}'}}</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

<h3 id="suggest"><a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/model-query/src/service/suggest.ts#L12">Suggest</a></h3>
Additionally, this same pattern avails it self in a set of suggestion methods that allow for powering auto completion and typeahead functionalities.

      <figure class="code">
      <figcaption class="code">Suggest
      <cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/model-query/src/service/suggest.ts#L12">Source</a></cite>
      </figcaption>
      <pre><code class="language-typescript"><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">ModelQuerySuggestSupport</span> <span class="token keyword">extends</span> <span class="token class-name">ModelQuerySupport</span> <span class="token punctuation">{{'{'}}</span>
  <span class="token comment">/**
   * Suggest instances for a given cls and a given field (allows for duplicates with as long as they have different ids)
   *
   * @param cls The model class to suggest on
   * @param field The field to suggest on
   * @param prefix The search prefix for the given field
   * @param query A query to filter the search on, in addition to the prefix
   */</span>
  <span class="token generic-function"><span class="token function">suggest</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> field<span class="token operator">:</span> ValidStringFields<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> prefix<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> query<span class="token operator">?</span><span class="token operator">:</span> PageableModelQuery<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Suggest distinct values for a given cls and a given field
   *
   * @param cls The model class to suggest on
   * @param field The field to suggest on
   * @param prefix The search prefix for the given field
   * @param query A query to filter the search on, in addition to the prefix
   */</span>
  <span class="token generic-function"><span class="token function">suggestValues</span><span class="token generic class-name"><span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> ModelType<span class="token operator">></span></span></span><span class="token punctuation">(</span>cls<span class="token operator">:</span> Class<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> field<span class="token operator">:</span> ValidStringFields<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">,</span> prefix<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> query<span class="token operator">?</span><span class="token operator">:</span> PageableModelQuery<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">></span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

<h2 id="implementations">Implementations</h2>

<table>
<thead>
<tr><th>Service</th><th>Query</th><th>QueryCrud</th><th>QueryFacet</th></tr>
</thead>
<tbody>
<tr><td><a class="module-link" routerLink="/docs/model-elasticsearch" title="Elasticsearch backing for the travetto model module, with real-time modeling support for Elasticsearch mappings.">Elasticsearch Model Source</a></td><td>X</td><td>X</td><td>X</td></tr>
<tr><td><a class="module-link" routerLink="/docs/model-mongo" title="Mongo backing for the travetto model module.">MongoDB Model Support</a></td><td>X</td><td>X</td><td>X</td></tr>
<tr><td><a class="module-link" routerLink="/docs/model-sql" title="SQL backing for the travetto model module, with real-time modeling support for SQL schemas.">SQL Model Service</a></td><td>X</td><td>X</td><td>X</td></tr>
</tbody>
</table>

<h2 id="querying">Querying</h2>

One of the complexities of abstracting multiple storage mechanisms, is providing a consistent query language.  The query language the module uses is a derivation of <a target="_blank" class="external-link" href="https://mongodb.com">mongodb</a>'s query language, with some restrictions, additions, and caveats. Additionally, given the nature of typescript, all queries are statically typed, and will catch type errors at compile time.

<h3 id="general-fields">General Fields</h3>
<ul> <li><code class="item input">field: {{'{'}} $eq: T {{'}'}}</code> to determine if a field is equal to a value</li>
 <li><code class="item input">field: {{'{'}} $ne: T {{'}'}}</code> to determine if a field is not equal to a value</li>
 <li><code class="item input">field: {{'{'}} $exists: boolean {{'}'}}</code> to determine if a field exists or not</li>
 <li><code class="item input">field: T</code> to see if the field is equal to whatever value is passed in</li></ul>

<h3 id="general-single-valued-fields">General Single Valued Fields</h3>
<ul> <li><code class="item input">field: {{'{'}} $in: T[] {{'}'}}</code> to see if a record's value appears in the array provided to <code class="item input">$in</code></li>
 <li><code class="item input">field: {{'{'}} $nin: T[] {{'}'}}</code> to see if a record's value does not appear in the array provided to <code class="item input">$in</code></li></ul>

<h3 id="ordered-numberic-fields">Ordered Numberic Fields</h3>
<ul> <li><code class="item input">field: {{'{'}} $lt: number {{'}'}}</code> checks if value is less than</li>
 <li><code class="item input">field: {{'{'}} $lte: number {{'}'}}</code> checks if value is less than or equal to</li>
 <li><code class="item input">field: {{'{'}} $gt: number {{'}'}}</code> checks if value is greater than</li>
 <li><code class="item input">field: {{'{'}} $gte: number {{'}'}}</code> checks if value is greater than or equal to</li></ul>
<h3 id="ordered-date-fields">Ordered Date Fields</h3>
<ul> <li><code class="item input">field: {{'{'}} $lt: Date | RelativeTime {{'}'}}</code> checks if value is less than</li>
 <li><code class="item input">field: {{'{'}} $lte: Date | RelativeTime {{'}'}}</code> checks if value is less than or equal to</li>
 <li><code class="item input">field: {{'{'}} $gt: Date | RelativeTime {{'}'}}</code> checks if value is greater than</li>
 <li><code class="item input">field: {{'{'}} $gte: Date | RelativeTime {{'}'}}</code> checks if value is greater than or equal to</li></ul>

<p class="note"><strong>Note</strong> Relative times are strings consisting of a number and a unit.  e.g. -1w or 30d.  These times are always relative to Date.now, but should make building  quieries more natural.</p>

<h3 id="array-fields">Array Fields</h3>
<ul> <li><code class="item input">field: {{'{'}} $all: T[]] {{'}'}}</code> checks to see if the records value contains everything within <code class="item input">$all</code></li></ul>

<h3 id="string-fields">String Fields</h3>
<ul> <li><code class="item input">field: {{'{'}} $regex: RegExp | string; {{'}'}}</code> checks the field against the regular expression</li></ul>

<h3 id="geo-point-fields">Geo Point Fields</h3>
<ul> <li><code class="item input">field: {{'{'}} $geoWithin: Point[] {{'}'}}</code> determines if the value is within the bounding region of the points</li>
 <li><code class="item input">field: {{'{'}} $near: Point, $maxDistance: number, $unit: 'km' | 'm' | 'mi' | 'ft' {{'}'}}</code> searches at a point, and looks out radially</li></ul>

<h3 id="groupings">Groupings</h3>
<ul> <li><code class="item input">{{'{'}} $and: [] {{'}'}}</code> provides a grouping in which all sub clauses are required</li>
 <li><code class="item input">{{'{'}} $or: [] {{'}'}}</code> provides a grouping in which at least one of the sub clauses is required</li>
 <li><code class="item input">{{'{'}} $not: {{'{'}} {{'}'}} {{'}'}}</code> negates a clause</li></ul>

A sample query for <code class="item input">User</code>'s might be:

      <figure class="code">
      <figcaption class="code">Using the query structure for specific queries
      <cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/model-query/doc/user-query.ts">Source</a></cite>
      </figcaption>
      <pre><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> ModelQuerySupport <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/model-query'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> User <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'./user'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">UserSearch</span> <span class="token punctuation">{{'{'}}</span>
  service<span class="token operator">:</span> ModelQuerySupport<span class="token punctuation">;</span>

  <span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>service<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>User<span class="token punctuation">,</span> <span class="token punctuation">{{'{'}}</span>
      where<span class="token operator">:</span> <span class="token punctuation">{{'{'}}</span>
        $and<span class="token operator">:</span> <span class="token punctuation">[</span>
          <span class="token punctuation">{{'{'}}</span>
            $not<span class="token operator">:</span> <span class="token punctuation">{{'{'}}</span>
              age<span class="token operator">:</span> <span class="token punctuation">{{'{'}}</span>
                $lt<span class="token operator">:</span> <span class="token number">35</span>
              <span class="token punctuation">{{'}'}}</span>
            <span class="token punctuation">{{'}'}}</span>
          <span class="token punctuation">{{'}'}}</span><span class="token punctuation">,</span>
          <span class="token punctuation">{{'{'}}</span>
            contact<span class="token operator">:</span> <span class="token punctuation">{{'{'}}</span>
              $exists<span class="token operator">:</span> <span class="token boolean">true</span>
            <span class="token punctuation">{{'}'}}</span>
          <span class="token punctuation">{{'}'}}</span>
        <span class="token punctuation">]</span>
      <span class="token punctuation">{{'}'}}</span>
    <span class="token punctuation">{{'}'}}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span>
<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

This would find all users who are over <code class="item input">35</code> and that have the <code class="item input">contact</code> field specified.

<h2 id="query-language">Query Language</h2>

In addition to the standard query interface, the module also supports querying by query language to facilitate end-user queries.  This is meant to act as an interface that is simpler to write than the default object structure.

The language itself is fairly simple, boolean logic, with parenthetical support.  The operators supported are:
<ul> <li><code class="item input">&lt;</code>, <code class="item input">&lt;=</code> - Less than, and less than or equal to</li>
 <li><code class="item input">&gt;</code>, <code class="item input">&gt;=</code> - Greater than, and greater than or equal to</li>
 <li><code class="item input">!=</code>, <code class="item input">==</code> - Not equal to, and equal to</li>
 <li><code class="item input">~</code> - Matches regular expression, supports the <code class="item input">i</code> flag to trigger case insensitive searches</li>
 <li><code class="item input">!</code>, <code class="item input">not</code> - Negates a clause</li>
 <li><code class="item input">in</code>, <code class="item input">not-in</code> - Supports checking if a field is in a list of literal values</li>
 <li><code class="item input">and</code>, <code class="item input">&amp;&amp;</code> - Intersection of clauses</li>
 <li><code class="item input">or</code>, <code class="item input">||</code> - Union of clauses</li></ul>

All sub fields are dot separated for access, e.g. <code class="item field">user.address.city</code>. A query language version of the previous query could look like:

      <figure class="code">
      <figcaption class="code">Query language with boolean checks and exists check
      
      </figcaption>
      <pre><code class="language-sql"><span class="token operator">not</span> <span class="token punctuation">(</span>age <span class="token operator">&lt;</span> <span class="token number">35</span><span class="token punctuation">)</span> <span class="token operator">and</span> contact <span class="token operator">!=</span> <span class="token boolean">null</span></code></pre>     
      </figure>

A more complex query would look like:

      <figure class="code">
      <figcaption class="code">Query language with more complex needs
      
      </figcaption>
      <pre><code class="language-sql"><span class="token keyword">user</span><span class="token punctuation">.</span>role <span class="token operator">in</span> <span class="token punctuation">[</span><span class="token string">'admin'</span><span class="token punctuation">,</span> <span class="token string">'root'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token keyword">user</span><span class="token punctuation">.</span>address<span class="token punctuation">.</span>state <span class="token operator">=</span><span class="token operator">=</span> <span class="token string">'VA'</span> <span class="token operator">||</span> <span class="token keyword">user</span><span class="token punctuation">.</span>address<span class="token punctuation">.</span>city <span class="token operator">=</span><span class="token operator">=</span> <span class="token string">'Springfield'</span><span class="token punctuation">)</span></code></pre>     
      </figure>

<h3 id="regular-expression">Regular Expression</h3>

When querying with regular expressions,patterns can be specified as <code class="item input">'strings'</code> or as <code class="item input">/patterns/</code>.  The latter allows for the case insensitive modifier: <code class="item input">/pattern/i</code>.  Supporting the insensitive flag is up to the underlying model implementation.

<h2 id="custom-model-query-service">Custom Model Query Service</h2>
In addition to the provided contracts, the module also provides common utilities and shared test suites.  The common utilities are useful for
repetitive functionality, that is unable to be shared due to not relying upon inheritance (this was an intentional design decision).  This allows for all the <a class="module-link" routerLink="/docs/model-query" title="Datastore abstraction for advanced query support.">Data Model Querying</a> implementations to completely own the functionality and also to be able to provide additional/unique functionality that goes beyond the interface.

To enforce that these contracts are honored, the module provides shared test suites to allow for custom implementations to ensure they are adhering to the contract's expected behavior.

      <figure class="code">
      <figcaption class="code">MongoDB Service Test Configuration
      <cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/model-mongo/test/service.query.ts">Source</a></cite>
      </figcaption>
      <pre><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> Suite <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/test'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> ModelQuerySuite <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/model-query/test-support/query'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> ModelQueryCrudSuite <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/model-query/test-support/crud'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> ModelQueryFacetSuite <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/model-query/test-support/facet'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> ModelQueryPolymorphismSuite <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/model-query/test-support/polymorphism'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> ModelQuerySuggestSuite <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/model-query/test-support/suggest'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> MongoModelConfig<span class="token punctuation">,</span> MongoModelService <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'..'</span><span class="token punctuation">;</span>

@<span class="token meta">Suite</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MongoQuerySuite</span> <span class="token keyword">extends</span> <span class="token class-name">ModelQuerySuite</span> <span class="token punctuation">{{'{'}}</span>
  serviceClass <span class="token operator">=</span> MongoModelService<span class="token punctuation">;</span>
  configClass <span class="token operator">=</span> MongoModelConfig<span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span>

@<span class="token meta">Suite</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MongoQueryCrudSuite</span> <span class="token keyword">extends</span> <span class="token class-name">ModelQueryCrudSuite</span> <span class="token punctuation">{{'{'}}</span>
  serviceClass <span class="token operator">=</span> MongoModelService<span class="token punctuation">;</span>
  configClass <span class="token operator">=</span> MongoModelConfig<span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span>

@<span class="token meta">Suite</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MongoQueryFacetSuite</span> <span class="token keyword">extends</span> <span class="token class-name">ModelQueryFacetSuite</span> <span class="token punctuation">{{'{'}}</span>
  serviceClass <span class="token operator">=</span> MongoModelService<span class="token punctuation">;</span>
  configClass <span class="token operator">=</span> MongoModelConfig<span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span>

@<span class="token meta">Suite</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MongoQueryPolymorphismSuite</span> <span class="token keyword">extends</span> <span class="token class-name">ModelQueryPolymorphismSuite</span> <span class="token punctuation">{{'{'}}</span>
  serviceClass <span class="token operator">=</span> MongoModelService<span class="token punctuation">;</span>
  configClass <span class="token operator">=</span> MongoModelConfig<span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span>

@<span class="token meta">Suite</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">MongoQuerySuggestSuite</span> <span class="token keyword">extends</span> <span class="token class-name">ModelQuerySuggestSuite</span> <span class="token punctuation">{{'{'}}</span>
  serviceClass <span class="token operator">=</span> MongoModelService<span class="token punctuation">;</span>
  configClass <span class="token operator">=</span> MongoModelConfig<span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>
</div>
