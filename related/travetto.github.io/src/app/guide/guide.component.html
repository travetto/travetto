<!-- This file was generated by @travetto/doc and should not be modified directly -->
<!-- Please modify https://github.com/travetto/travetto/tree/master/related/todo-app/doc.ts and execute "npx trv doc" to rebuild -->
<h1>Getting Started: A Todo App
          
        </h1>

The following tutorial wil walk you through setting up a <a target="_blank" class="external-link" href="https://travetto.dev">Travetto</a> application from scratch.  We'll be building a simple todo application. The entire source of the finished project can be found at <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/master">Todo App</a>.  Additionally, you can use the <a class="module-link" routerLink="/docs/scaffold" title="App Scaffold for the Travetto framework">App Scaffold</a>.

<div class="toc"><div class="inner"><h3 id="overview">Overview</h3><ol> <li><a class="anchor-link" routerLink="." fragment="prerequisites">Prerequisites</a></li>
 <li><a class="anchor-link" routerLink="." fragment="project-initialization">Project Initialization</a></li>
 <li><a class="anchor-link" routerLink="." fragment="establishing-the-model">Establishing The Model</a></li>
 <li><a class="anchor-link" routerLink="." fragment="building-the-service-layer">Building the Service Layer</a></li>
 <li><a class="anchor-link" routerLink="." fragment="writing-unit-tests">Writing Unit tests</a></li>
 <li><a class="anchor-link" routerLink="." fragment="adding-rest-routes">Adding Rest Routes</a></li>
 <li><a class="anchor-link" routerLink="." fragment="running-the-app">Running the App</a></li></ol></div></div>

<h2 id="prerequisites">Prerequisites</h2>

Install
<ul> <li><a target="_blank" class="external-link" href="https://nodejs.org/en/download/current/">Node</a> v15.x+ (recommended, but v12.x+ supported)</li>
 <li><a target="_blank" class="external-link" href="https://docs.mongodb.com/manual/administration/install-community/">Mongodb</a> 3.6+ (required)</li>
 <li><a target="_blank" class="external-link" href="https://code.visualstudio.com/download">VSCode</a> (recommended)</li>
 <li><a target="_blank" class="external-link" href="https://marketplace.visualstudio.com/items?itemName=arcsine.travetto-plugin">VSCode plugin</a> (recommended)</li></ul>

<h2 id="project-initialization">Project Initialization</h2>

      <figure class="terminal">
      <figcaption class="terminal">Getting Ready
      
      </figcaption>
      <pre><code class="language-bash">$ <span class="token function">mkdir</span> todo-project
$ <span class="token builtin class-name">cd</span> todo-project

$ <span class="token function">git</span> init <span class="token builtin class-name">.</span>

$ <span class="token function">npm</span> init -f
$ <span class="token function">npm</span> i @travetto/<span class="token punctuation">{{'{'}}</span>log,test,rest-express,model-mongo<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

<h2 id="establishing-the-model">Establishing The Model</h2>

Let's create the model for the todo application.  The fields we will need should be:

<ul> <li><code class="item field">id</code> as a unique identifier</li>
 <li><code class="item field">text</code> as the actual todo information</li>
 <li><code class="item field">created</code> the date the todo was created</li>
 <li><code class="item field">completed</code> whether or not the todo was completed</li></ul>

Create the file <code class="item path">src/model.ts</code>

      <figure class="code">
      <figcaption class="code">Models
      <cite><a target="_blank" href="https://github.com/travetto/travetto/tree/master/src/model.ts">Source</a></cite>
      </figcaption>
      <pre><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> Model <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/model'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> Schema <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/schema'</span><span class="token punctuation">;</span>

@<span class="token meta">Model</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">Todo</span> <span class="token punctuation">{{'{'}}</span>
  id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  text<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  created<span class="token operator">?</span><span class="token operator">:</span> Date<span class="token punctuation">;</span>
  completed<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  priority<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  who<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  color<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span>

@<span class="token meta">Schema</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">TodoSearch</span> <span class="token punctuation">{{'{'}}</span>
  offset<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
  limit<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

as you can see, the model structure is simple.  Everything that uses the <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/master/module/model/src/registry/decorator.ts#L13">@Model</a> services needs to implement <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/master/module/model/src/types/model.ts#L1">ModelType</a>.

<h2 id="building-the-service-layer">Building the Service Layer</h2>

Next we establish the functionality for the service layer. The operations we need are:
<ul> <li>Create a new todo</li>
 <li>Complete a todo</li>
 <li>Remove a todo</li>
 <li>Get all todos</li></ul>

Now we need to create <code class="item path">src/service.ts</code>

      <figure class="code">
      <figcaption class="code">Service Definition
      <cite><a target="_blank" href="https://github.com/travetto/travetto/tree/master/src/service.ts">Source</a></cite>
      </figcaption>
      <pre><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> ElasticsearchModelService <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/model-elasticsearch'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> Injectable<span class="token punctuation">,</span> Inject <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/di'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> Todo<span class="token punctuation">,</span> TodoSearch <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'./model'</span><span class="token punctuation">;</span>

@<span class="token meta">Injectable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">TodoService</span> <span class="token punctuation">{{'{'}}</span>

  @<span class="token meta">Inject</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> modelService<span class="token operator">:</span> ElasticsearchModelService<span class="token punctuation">;</span>

  <span class="token keyword">async</span> <span class="token function">add</span><span class="token punctuation">(</span>todo<span class="token operator">:</span> Todo<span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
    todo<span class="token punctuation">.</span>created <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> saved <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>modelService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>Todo<span class="token punctuation">,</span> todo<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> saved<span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span>

  <span class="token keyword">async</span> <span class="token keyword">get</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>modelService<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span>Todo<span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span>

  <span class="token keyword">async</span> <span class="token function">getAll</span><span class="token punctuation">(</span>search<span class="token operator">:</span> TodoSearch<span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>modelService<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>Todo<span class="token punctuation">,</span> <span class="token punctuation">{{'{'}}</span> <span class="token operator">...</span>search<span class="token punctuation">,</span> sort<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{{'{'}}</span> created<span class="token operator">:</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token punctuation">{{'}'}}</span><span class="token punctuation">]</span> <span class="token punctuation">{{'}'}}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span>

  <span class="token keyword">async</span> <span class="token function">complete</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> completed <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>modelService<span class="token punctuation">.</span><span class="token function">updatePartial</span><span class="token punctuation">(</span>Todo<span class="token punctuation">,</span> Todo<span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span><span class="token punctuation">{{'{'}}</span> id<span class="token punctuation">,</span> completed <span class="token punctuation">{{'}'}}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span>

  <span class="token keyword">async</span> <span class="token function">remove</span><span class="token punctuation">(</span>id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>modelService<span class="token punctuation">.</span><span class="token keyword">delete</span><span class="token punctuation">(</span>Todo<span class="token punctuation">,</span> id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span>
<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

<h2 id="writing-unit-tests">Writing Unit tests</h2>

After we have established our service layer, we will now construct some simple tests to verify the service layer is running correctly. By default we set the database schema name under <code class="item path">test/resources/application.yml</code> to ensure we aren't writing to our dev database.

      <figure class="code">
      <figcaption class="code">Test YAML
      <cite><a target="_blank" href="https://github.com/travetto/travetto/tree/master/test/resources/application.yml">Source</a></cite>
      </figcaption>
      <pre><code class="language-yaml"><span class="token punctuation">---</span>
<span class="token key atrule">mongo.model.namespace</span><span class="token punctuation">:</span> app<span class="token punctuation">-</span>test</code></pre>     
      </figure>

Now the tests should be defined at <code class="item path">test/service.ts</code>

      <figure class="code">
      <figcaption class="code">Test bed
      <cite><a target="_blank" href="https://github.com/travetto/travetto/tree/master/test/service.ts">Source</a></cite>
      </figcaption>
      <pre><code class="language-typescript"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> assert <span class="token keyword">from</span> <span class="token string">'assert'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> Suite<span class="token punctuation">,</span> Test <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/test'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> Inject <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/di'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> ElasticsearchModelConfig<span class="token punctuation">,</span> ElasticsearchModelService <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/model-elasticsearch'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> InjectableSuite <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/di/test-support/suite'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> ModelSuite <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/model/test-support/suite'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> TodoService <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'../src/service'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> Todo <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'../src/model'</span><span class="token punctuation">;</span>

@<span class="token meta">Suite</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
@<span class="token meta">ModelSuite</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
@<span class="token meta">InjectableSuite</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">TodoTest</span> <span class="token punctuation">{{'{'}}</span>

  serviceClass <span class="token operator">=</span> ElasticsearchModelService<span class="token punctuation">;</span>
  configClass <span class="token operator">=</span> ElasticsearchModelConfig<span class="token punctuation">;</span>

  @<span class="token meta">Inject</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  svc<span class="token operator">:</span> TodoService<span class="token punctuation">;</span>

  @<span class="token meta">Test</span><span class="token punctuation">(</span><span class="token string">'Create todo'</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
    <span class="token keyword">const</span> test <span class="token operator">=</span> Todo<span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span><span class="token punctuation">{{'{'}}</span>
      text<span class="token operator">:</span> <span class="token string">'Sample Task'</span>
    <span class="token punctuation">{{'}'}}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> saved <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>svc<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span>

    assert<span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span>saved<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span>

  @<span class="token meta">Test</span><span class="token punctuation">(</span><span class="token string">'Complete todo'</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">complete</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
    <span class="token keyword">const</span> test <span class="token operator">=</span> Todo<span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span><span class="token punctuation">{{'{'}}</span>
      text<span class="token operator">:</span> <span class="token string">'Sample Task'</span>
    <span class="token punctuation">{{'}'}}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> saved <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>svc<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span>
    assert<span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span>saved<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">let</span> updated <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>svc<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span>saved<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">assert</span><span class="token punctuation">(</span>updated<span class="token punctuation">.</span>completed <span class="token operator">===</span> <span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    updated <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>svc<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span>saved<span class="token punctuation">.</span>id<span class="token punctuation">,</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">assert</span><span class="token punctuation">(</span>updated<span class="token punctuation">.</span>completed <span class="token operator">===</span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span>

  @<span class="token meta">Test</span><span class="token punctuation">(</span><span class="token string">'Delete todo'</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
    <span class="token keyword">const</span> test <span class="token operator">=</span> Todo<span class="token punctuation">.</span><span class="token keyword">from</span><span class="token punctuation">(</span><span class="token punctuation">{{'{'}}</span>
      text<span class="token operator">:</span> <span class="token string">'Sample Task'</span>
    <span class="token punctuation">{{'}'}}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> saved <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>svc<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span>
    assert<span class="token punctuation">.</span><span class="token function">ok</span><span class="token punctuation">(</span>saved<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">assert</span><span class="token punctuation">(</span>test<span class="token punctuation">.</span>text <span class="token operator">===</span> <span class="token string">'Sample Task'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>svc<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>saved<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">try</span> <span class="token punctuation">{{'{'}}</span>
      <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>svc<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span>saved<span class="token punctuation">.</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">{{'}'}}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>e<span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
      <span class="token function">assert</span><span class="token punctuation">(</span>e<span class="token punctuation">.</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">{{'}'}}</span>
  <span class="token punctuation">{{'}'}}</span>
<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

<h2 id="adding-rest-routes">Adding Rest Routes</h2>
Now we establish the routes, providing an interface to the service layer.

Finally, we establish the controller at <code class="item path">src/route.ts</code>

      <figure class="code">
      <figcaption class="code">Controller contents
      <cite><a target="_blank" href="https://github.com/travetto/travetto/tree/master/src/route.ts">Source</a></cite>
      </figcaption>
      <pre><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> Controller<span class="token punctuation">,</span> Get<span class="token punctuation">,</span> Post<span class="token punctuation">,</span> Put<span class="token punctuation">,</span> Delete<span class="token punctuation">,</span> Path<span class="token punctuation">,</span> Query<span class="token punctuation">,</span> SchemaBody<span class="token punctuation">,</span> SchemaQuery <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/rest'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> Inject <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/di'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> TodoService <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'./service'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> Todo<span class="token punctuation">,</span> TodoSearch <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'./model'</span><span class="token punctuation">;</span>

@<span class="token meta">Controller</span><span class="token punctuation">(</span><span class="token string">'/todo'</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">TodoController</span> <span class="token punctuation">{{'{'}}</span>

  @<span class="token meta">Inject</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token keyword">private</span> svc<span class="token operator">:</span> TodoService<span class="token punctuation">;</span>

  <span class="token comment">/**
   * Get all todos
   */</span>
  @<span class="token meta">Get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">getAll</span><span class="token punctuation">(</span>@<span class="token meta">SchemaQuery</span><span class="token punctuation">(</span><span class="token punctuation">)</span> search<span class="token operator">:</span> TodoSearch<span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
    <span class="token keyword">const</span> itr <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>svc<span class="token punctuation">.</span><span class="token function">getAll</span><span class="token punctuation">(</span>search<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> out <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span> <span class="token keyword">await</span> <span class="token punctuation">(</span><span class="token keyword">const</span> item <span class="token keyword">of</span> itr<span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
      out<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>item<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">{{'}'}}</span>
    <span class="token keyword">return</span> out<span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span>

  <span class="token comment">/**
   * Get Todo by id
   * @param id Todo id
   */</span>
  @<span class="token meta">Get</span><span class="token punctuation">(</span><span class="token string">'/:id'</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">getById</span><span class="token punctuation">(</span>@<span class="token meta">Path</span><span class="token punctuation">(</span><span class="token punctuation">)</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>svc<span class="token punctuation">.</span><span class="token keyword">get</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span>

  <span class="token comment">/**
   * Create a todo
   */</span>
  @<span class="token meta">Post</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">create</span><span class="token punctuation">(</span>@<span class="token meta">SchemaBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span> todo<span class="token operator">:</span> Todo<span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
    <span class="token keyword">return</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>svc<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>todo<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span>

  <span class="token comment">/**
   * Complete a todo
   * @param id Todo id
   */</span>
  @<span class="token meta">Put</span><span class="token punctuation">(</span><span class="token string">'/:id/complete'</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">complete</span><span class="token punctuation">(</span>@<span class="token meta">Path</span><span class="token punctuation">(</span><span class="token punctuation">)</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> @<span class="token meta">Query</span><span class="token punctuation">(</span><span class="token punctuation">)</span> completed<span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
    <span class="token keyword">return</span> <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>svc<span class="token punctuation">.</span><span class="token function">complete</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> completed<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span>

  <span class="token comment">/**
   * Delete a todo
   * @param id Todo id
   */</span>
  @<span class="token meta">Delete</span><span class="token punctuation">(</span><span class="token string">'/:id'</span><span class="token punctuation">)</span>
  <span class="token keyword">async</span> <span class="token function">remove</span><span class="token punctuation">(</span>@<span class="token meta">Path</span><span class="token punctuation">(</span><span class="token punctuation">)</span> id<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
    <span class="token keyword">await</span> <span class="token keyword">this</span><span class="token punctuation">.</span>svc<span class="token punctuation">.</span><span class="token function">remove</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span>
<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

<h2 id="running-the-app">Running the App</h2>

First we must start the application:

      <figure class="terminal">
      <figcaption class="terminal">Application Startup
      
      </figcaption>
      <pre><code class="language-bash"><span class="token number">2021</span>-03-14T05:00:00.618Z info  <span class="token punctuation">[</span>@trv:app/registry:40<span class="token punctuation">]</span> Running application <span class="token punctuation">{{'{'}}</span> name: <span class="token string">'rest'</span>, filename: <span class="token string">'@trv:rest/src/application/rest.ts'</span> <span class="token punctuation">{{'}'}}</span>
<span class="token number">2021</span>-03-14T05:00:00.837Z info  <span class="token punctuation">[</span>@trv:app/registry:44<span class="token punctuation">]</span> Configured <span class="token punctuation">{{'{'}}</span>
  info: <span class="token punctuation">{{'{'}}</span>
    name: <span class="token string">'@travetto/todo-app'</span>,
    description: <span class="token string">''</span>,
    version: undefined,
    license: <span class="token string">'ISC'</span>,
    author: <span class="token punctuation">{{'{'}}</span> email: <span class="token string">'travetto.framework@gmail.com'</span>, name: <span class="token string">'Travetto Framework'</span> <span class="token punctuation">{{'}'}}</span>,
    baseVersion: <span class="token string">'2.0.0'</span>
  <span class="token punctuation">{{'}'}}</span>,
  env: <span class="token punctuation">{{'{'}}</span>
    name: <span class="token string">'dev'</span>,
    profiles: <span class="token punctuation">[</span> <span class="token string">'application'</span>, <span class="token string">'dev'</span> <span class="token punctuation">]</span>,
    prod: false,
    debug: <span class="token punctuation">{{'{'}}</span> status: false, value: undefined <span class="token punctuation">{{'}'}}</span>,
    resources: <span class="token punctuation">[</span> <span class="token string">'resources'</span>, <span class="token string">'doc/resources'</span> <span class="token punctuation">]</span>,
    shutdownWait: <span class="token number">2000</span>,
    watch: true,
    readonly: <span class="token boolean">false</span>
  <span class="token punctuation">{{'}'}}</span>,
  source: <span class="token punctuation">{{'{'}}</span>
    common: <span class="token punctuation">[</span> <span class="token string">'src'</span> <span class="token punctuation">]</span>,
    local: <span class="token punctuation">[</span> <span class="token string">'doc'</span> <span class="token punctuation">]</span>,
    excludeModules: Set<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span> <span class="token string">'@travetto/cli'</span>, <span class="token string">'@travetto/doc'</span>, <span class="token string">'@travetto/boot'</span> <span class="token punctuation">{{'}'}}</span>,
    dynamicModules: <span class="token punctuation">{{'{'}}</span>
      <span class="token string">'@travetto/app'</span><span class="token builtin class-name">:</span> <span class="token string">'@trv:app'</span>,
      <span class="token string">'@travetto/auth'</span><span class="token builtin class-name">:</span> <span class="token string">'@trv:auth'</span>,
      <span class="token string">'@travetto/auth-rest'</span><span class="token builtin class-name">:</span> <span class="token string">'@trv:auth-rest'</span>,
      <span class="token string">'@travetto/base'</span><span class="token builtin class-name">:</span> <span class="token string">'@trv:base'</span>,
      <span class="token string">'@travetto/boot'</span><span class="token builtin class-name">:</span> <span class="token string">'@trv:boot'</span>,
      <span class="token string">'@travetto/cli'</span><span class="token builtin class-name">:</span> <span class="token string">'@trv:cli'</span>,
      <span class="token string">'@travetto/compiler'</span><span class="token builtin class-name">:</span> <span class="token string">'@trv:compiler'</span>,
      <span class="token string">'@travetto/config'</span><span class="token builtin class-name">:</span> <span class="token string">'@trv:config'</span>,
      <span class="token string">'@travetto/context'</span><span class="token builtin class-name">:</span> <span class="token string">'@trv:context'</span>,
      <span class="token string">'@travetto/di'</span><span class="token builtin class-name">:</span> <span class="token string">'@trv:di'</span>,
      <span class="token string">'@travetto/doc'</span><span class="token builtin class-name">:</span> <span class="token string">'@trv:doc'</span>,
      <span class="token string">'@travetto/log'</span><span class="token builtin class-name">:</span> <span class="token string">'@trv:log'</span>,
      <span class="token string">'@travetto/model'</span><span class="token builtin class-name">:</span> <span class="token string">'@trv:model'</span>,
      <span class="token string">'@travetto/model-elasticsearch'</span><span class="token builtin class-name">:</span> <span class="token string">'@trv:model-elasticsearch'</span>,
      <span class="token string">'@travetto/model-query'</span><span class="token builtin class-name">:</span> <span class="token string">'@trv:model-query'</span>,
      <span class="token string">'@travetto/openapi'</span><span class="token builtin class-name">:</span> <span class="token string">'@trv:openapi'</span>,
      <span class="token string">'@travetto/pack'</span><span class="token builtin class-name">:</span> <span class="token string">'@trv:pack'</span>,
      <span class="token string">'@travetto/registry'</span><span class="token builtin class-name">:</span> <span class="token string">'@trv:registry'</span>,
      <span class="token string">'@travetto/rest'</span><span class="token builtin class-name">:</span> <span class="token string">'@trv:rest'</span>,
      <span class="token string">'@travetto/rest-express'</span><span class="token builtin class-name">:</span> <span class="token string">'@trv:rest-express'</span>,
      <span class="token string">'@travetto/rest-session'</span><span class="token builtin class-name">:</span> <span class="token string">'@trv:rest-session'</span>,
      <span class="token string">'@travetto/schema'</span><span class="token builtin class-name">:</span> <span class="token string">'@trv:schema'</span>,
      <span class="token string">'@travetto/test'</span><span class="token builtin class-name">:</span> <span class="token string">'@trv:test'</span>,
      <span class="token string">'@travetto/transformer'</span><span class="token builtin class-name">:</span> <span class="token string">'@trv:transformer'</span>,
      <span class="token string">'@travetto/watch'</span><span class="token builtin class-name">:</span> <span class="token string">'@trv:watch'</span>,
      <span class="token string">'@travetto/worker'</span><span class="token builtin class-name">:</span> <span class="token string">'@trv:worker'</span>,
      <span class="token string">'@travetto/yaml'</span><span class="token builtin class-name">:</span> <span class="token string">'@trv:yaml'</span>
    <span class="token punctuation">{{'}'}}</span>
  <span class="token punctuation">{{'}'}}</span>,
  config: <span class="token punctuation">{{'{'}}</span>
    rest: <span class="token punctuation">{{'{'}}</span> cors: <span class="token punctuation">{{'{'}}</span> active: <span class="token boolean">true</span> <span class="token punctuation">{{'}'}}</span> <span class="token punctuation">{{'}'}}</span>,
    api: <span class="token punctuation">{{'{'}}</span> spec: <span class="token punctuation">{{'{'}}</span> output: <span class="token string">'./openapi.yml'</span> <span class="token punctuation">{{'}'}}</span> <span class="token punctuation">{{'}'}}</span>,
    sql: <span class="token punctuation">{{'{'}}</span> model: <span class="token punctuation">{{'{'}}</span> namespace: <span class="token string">'todo'</span>, user: <span class="token string">'root'</span>, password: <span class="token string">'password'</span> <span class="token punctuation">{{'}'}}</span> <span class="token punctuation">{{'}'}}</span>
  <span class="token punctuation">{{'}'}}</span>
<span class="token punctuation">{{'}'}}</span>
<span class="token number">2021</span>-03-14T05:00:01.510Z info  <span class="token punctuation">[</span>@trv:rest/application/rest:192<span class="token punctuation">]</span> Listening <span class="token punctuation">{{'{'}}</span> port: <span class="token number">3000</span> <span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

next, let's execute <a target="_blank" class="external-link" href="https://www.npmjs.com/package/node-fetch">fetch</a> requests to interact with the new api:

      <figure class="code">
      <figcaption class="code">Creating Todo by curl
      <cite><a target="_blank" href="https://github.com/travetto/travetto/tree/master/doc/create-todo.ts">Source</a></cite>
      </figcaption>
      <pre><code class="language-typescript"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> fetch <span class="token keyword">from</span> <span class="token string">'node-fetch'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'http://localhost:3000/todo'</span><span class="token punctuation">,</span> <span class="token punctuation">{{'{'}}</span>
    method<span class="token operator">:</span> <span class="token string">'POST'</span><span class="token punctuation">,</span>
    body<span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{{'{'}}</span> text<span class="token operator">:</span> <span class="token string">'New Todo'</span> <span class="token punctuation">{{'}'}}</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    headers<span class="token operator">:</span> <span class="token punctuation">{{'{'}}</span>
      <span class="token string">'Content-Type'</span><span class="token operator">:</span> <span class="token string">'application/json'</span>
    <span class="token punctuation">{{'}'}}</span>
  <span class="token punctuation">{{'}'}}</span><span class="token punctuation">)</span>
    <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>r <span class="token operator">=></span> r<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span>log<span class="token operator">!</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

      <figure class="terminal">
      <figcaption class="terminal">Create Output
      
      </figcaption>
      <pre><code class="language-bash">$ node @travetto/boot/bin/main ./doc/create-todo.ts

<span class="token punctuation">{{'{'}}</span>
  text: <span class="token string">'New Todo'</span>,
  created: <span class="token string">'2021-03-14T05:00:02.450Z'</span>,
  id: <span class="token string">'422e793aed76ee063d13feec2e5e95b4'</span>
<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

      <figure class="code">
      <figcaption class="code">Listing Todos by curl
      <cite><a target="_blank" href="https://github.com/travetto/travetto/tree/master/doc/list-todo.ts">Source</a></cite>
      </figcaption>
      <pre><code class="language-typescript"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> fetch <span class="token keyword">from</span> <span class="token string">'node-fetch'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">fetch</span><span class="token punctuation">(</span><span class="token string">'http://localhost:3000/todo'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span>r <span class="token operator">=></span> r<span class="token punctuation">.</span><span class="token function">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token builtin">console</span><span class="token punctuation">.</span>log<span class="token operator">!</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span></code></pre>     
      </figure>

      <figure class="terminal">
      <figcaption class="terminal">Listing Output
      
      </figcaption>
      <pre><code class="language-bash">$ node @travetto/boot/bin/main ./doc/list-todo.ts

<span class="token punctuation">[</span>
  <span class="token punctuation">{{'{'}}</span>
    id: <span class="token string">'422e793aed76ee063d13feec2e5e95b4'</span>,
    text: <span class="token string">'New Todo'</span>,
    created: <span class="token string">'2021-03-14T05:00:02.819Z'</span>
  <span class="token punctuation">{{'}'}}</span>
<span class="token punctuation">]</span></code></pre>     
      </figure>
