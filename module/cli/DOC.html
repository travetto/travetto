<!-- This file was generated by @travetto/doc and should not be modified directly -->
<!-- Please modify https://github.com/travetto/travetto/tree/main/module/cli/DOC.tsx and execute "npx trv doc" to rebuild -->
<h1>Command Line Interface
<small>CLI infrastructure for Travetto framework</small>
</h1>

  <figure class="install">
    <figcaption class="install">Install @travetto/cli
    
    </figcaption>
    <pre><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> @travetto/cli

<span class="token comment"># or</span>

<span class="token function">yarn</span> <span class="token function">add</span> @travetto/cli</code></pre>
  </figure>

The cli module represents the primary entry point for execution within the framework. One of the main goals for this module is extensibility, as adding new entry points is meant to be trivial. The framework leverages this module for exposing all executable tools and entry points.  To see a high level listing of all supported commands, invoke <code class="item input">trv --help</code>

  <figure class="terminal">
    <figcaption class="terminal">General Usage

</figcaption>
    <pre><code class="language-bash">$ trv <span class="token parameter variable">--help</span>

Usage:  <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token punctuation">[</span>command<span class="token punctuation">]</span>

Commands:
  doc               Command line support <span class="token keyword">for</span> generating module docs.
  doc:angular       Generate documentation into the angular webapp under related/travetto.github.io
  doc:mapping       Generate module mapping <span class="token keyword">for</span>
  email:compile     CLI Entry point <span class="token keyword">for</span> running the email server
  email:editor      The email editor compilation <span class="token function">service</span> and output serving
  email:test        CLI Entry point <span class="token keyword">for</span> running the email server
  eslint            Command line support <span class="token keyword">for</span> eslint
  eslint:register   Writes the eslint configuration <span class="token function">file</span>
  model:export      Exports model schemas
  model:install     Installing models
  openapi:client    CLI <span class="token keyword">for</span> generating the cli client
  openapi:spec      CLI <span class="token keyword">for</span> outputting the <span class="token function">open</span> api spec to a <span class="token builtin class-name">local</span> <span class="token function">file</span>
  pack              Standard pack support
  pack:docker       Standard <span class="token function">docker</span> support <span class="token keyword">for</span> pack
  pack:lambda       Standard lambda support <span class="token keyword">for</span> pack
  pack:zip          Standard <span class="token function">zip</span> support <span class="token keyword">for</span> pack
  repo:exec         Repo execution
  repo:list         Allows <span class="token keyword">for</span> listing of modules
  repo:publish      Publish all pending modules
  repo:version      Version all changed dependencies
  repo:version-sync Enforces all packages to <span class="token function">write</span> out their versions and dependencies
  run:double        Doubles a number
  scaffold          Command to run scaffolding
  <span class="token function">service</span>           Allows <span class="token keyword">for</span> running services
  <span class="token builtin class-name">test</span>              Launch <span class="token builtin class-name">test</span> framework and execute tests
  test:watch        Invoke the <span class="token builtin class-name">test</span> watcher
  web:http          Run a web server
  web:rpc-client    Generate the web-rpc client</code></pre>
  </figure>

This listing is from the <a target="_blank" class="external-link" href="https://travetto.dev">Travetto</a> monorepo, and represents the majority of tools that can be invoked from the command line. <br><br>
This module also has a tight integration with the <a target="_blank" class="external-link" href="https://marketplace.visualstudio.com/items?itemName=arcsine.travetto-plugin">VSCode plugin</a>, allowing the editing experience to benefit from the commands defined. The most commonly used commands will be the ones packaged with the framework, but its also very easy to create new commands.  With the correct configuration, these commands will also be exposed within VSCode.<br><br>
At it's heart, a cli command is the contract defined by what flags, and what arguments the command supports. Within the framework this requires three criteria to be met:
<ul> <li>The file must be located in the <code class="item path">support/</code> folder, and have a name that matches <code class="item path">cli.*.ts</code></li>
<li>The file must be a class that has a main method</li>
<li>The class must use the <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/cli/src/registry/decorator.ts#L98">@CliCommand</a> decorator</li>
</ul>

  <figure class="code">
    <figcaption class="code">Basic Command
<cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/cli/doc/cli.basic.ts">Source</a></cite>

</figcaption>
    <pre><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> CliCommand <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/cli'</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">CliCommand</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">BasicCommand</span> <span class="token punctuation">{{'{'}}</span>
  <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span>
<span class="token punctuation">{{'}'}}</span></code></pre>
  </figure>

  <figure class="terminal">
    <figcaption class="terminal">Basic Command Help

</figcaption>
    <pre><code class="language-bash">$ trv basic <span class="token parameter variable">-h</span>

Usage: basic <span class="token punctuation">[</span>options<span class="token punctuation">]</span>

Options:
  -h, <span class="token parameter variable">--help</span>  display <span class="token builtin class-name">help</span> <span class="token keyword">for</span> <span class="token builtin class-name">command</span></code></pre>
  </figure>

<h2 id="command-naming">Command Naming</h2>

The file name <code class="item path">support/cli.&lt;name&gt;.ts</code> has a direct mapping to the cli command name.   This hard mapping allows for the framework to be able to know which file to invoke without needing to load all command-related files. <br><br>
Examples of mappings:
<ul> <li><code class="item path">cli.test.ts</code> maps to <code class="item input">test</code></li>
<li><code class="item path">cli.pack_docker.ts</code> maps to <code class="item input">pack:docker</code></li>
<li><code class="item path">cli.email_template.ts</code> maps to <code class="item input">email:template</code></li>
</ul>
The pattern is that underscores(_) translate to colons (:), and the <code class="item input">cli.</code> prefix, and <code class="item input">.ts</code> suffix are dropped.

<h2 id="binding-flags">Binding Flags</h2>

<a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/cli/src/registry/decorator.ts#L98">@CliCommand</a> is a wrapper for <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/schema/src/decorator/schema.ts#L19">@Schema</a>, and so every class that uses the <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/cli/src/registry/decorator.ts#L98">@CliCommand</a> decorator is now a full <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/schema/src/decorator/schema.ts#L19">@Schema</a> class. The fields of the class represent the flags that are available to the command.

  <figure class="code">
    <figcaption class="code">Basic Command with Flag
<cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/cli/doc/cli.basic_flag.ts">Source</a></cite>

</figcaption>
    <pre><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> CliCommand <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/cli'</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">CliCommand</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">BasicCommand</span> <span class="token punctuation">{{'{'}}</span>

  loud<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>

  <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>loud <span class="token operator">?</span> <span class="token string">'HELLO'</span> <span class="token operator">:</span> <span class="token string">'Hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span>
<span class="token punctuation">{{'}'}}</span></code></pre>
  </figure>

  <figure class="terminal">
    <figcaption class="terminal">Basic Command with Flag Help

</figcaption>
    <pre><code class="language-bash">$ trv basic:flag <span class="token parameter variable">-h</span>

Usage: basic:flag <span class="token punctuation">[</span>options<span class="token punctuation">]</span>

Options:
  -l, <span class="token parameter variable">--loud</span>
  -h, <span class="token parameter variable">--help</span>  display <span class="token builtin class-name">help</span> <span class="token keyword">for</span> <span class="token builtin class-name">command</span></code></pre>
  </figure>

As you can see the command now has the support of a basic boolean flag to determine if the response should be loud or not.  The default value here is undefined/false, and so is an opt-in experience.

  <figure class="terminal">
    <figcaption class="terminal">Basic Command with Loud Flag

</figcaption>
    <pre><code class="language-bash">$ trv basic:flag <span class="token parameter variable">--loud</span>

HELLO</code></pre>
  </figure>

The <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/cli/src/registry/decorator.ts#L98">@CliCommand</a> supports the following data types for flags:
<ul> <li>Boolean values</li>
<li>Number values. The <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/schema/src/decorator/input.ts#L172">@Integer</a>, <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/schema/src/decorator/input.ts#L179">@Float</a>, <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/schema/src/decorator/input.ts#L165">@Precision</a>, <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/schema/src/decorator/input.ts#L99">@Min</a> and <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/schema/src/decorator/input.ts#L110">@Max</a> decorators help provide additional validation.</li>
<li>String values. <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/schema/src/decorator/input.ts#L99">@MinLength</a>, <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/schema/src/decorator/input.ts#L110">@MaxLength</a>, <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/schema/src/decorator/input.ts#L90">@Match</a> and <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/schema/src/decorator/input.ts#L64">@Enum</a> provide additional constraints</li>
<li>Date values. The <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/schema/src/decorator/input.ts#L99">@Min</a> and <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/schema/src/decorator/input.ts#L110">@Max</a> decorators help provide additional validation.</li>
<li>String lists. Same as String, but allowing multiple values.</li>
<li>Numeric lists. Same as Number, but allowing multiple values.</li>
</ul>

<h2 id="binding-arguments">Binding Arguments</h2>

The <code class="item method">main()</code> method is the entrypoint for the command, represents a series of parameters. Some will be required, some may be optional.  The arguments support all types supported by the flags, and decorators can be provided using the decorators inline on parameters.     Optional arguments in the method, will be optional at run time, and filled with the provided default values.

  <figure class="code">
    <figcaption class="code">Basic Command with Arg
<cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/cli/doc/cli.basic_arg.ts">Source</a></cite>

</figcaption>
    <pre><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> CliCommand <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/cli'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> Max<span class="token punctuation">,</span> Min <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/schema'</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">CliCommand</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">BasicCommand</span> <span class="token punctuation">{{'{'}}</span>

  <span class="token function">main</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Min</span></span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">Max</span></span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> volume<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>volume <span class="token operator">></span> <span class="token number">7</span> <span class="token operator">?</span> <span class="token string">'HELLO'</span> <span class="token operator">:</span> <span class="token string">'Hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span>
<span class="token punctuation">{{'}'}}</span></code></pre>
  </figure>

  <figure class="terminal">
    <figcaption class="terminal">Basic Command

</figcaption>
    <pre><code class="language-bash">$ trv basic:arg <span class="token parameter variable">-h</span>

Usage: basic:arg <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token punctuation">[</span>volume:number<span class="token punctuation">]</span>

Options:
  -h, <span class="token parameter variable">--help</span>  display <span class="token builtin class-name">help</span> <span class="token keyword">for</span> <span class="token builtin class-name">command</span></code></pre>
  </figure>

  <figure class="terminal">
    <figcaption class="terminal">Basic Command with Invalid Loud Arg

</figcaption>
    <pre><code class="language-bash">$ trv basic:arg <span class="token number">20</span>

Execution failed:
 * Argument volume is greater than <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>

Usage: basic:arg <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token punctuation">[</span>volume:number<span class="token punctuation">]</span>

Options:
  -h, <span class="token parameter variable">--help</span>  display <span class="token builtin class-name">help</span> <span class="token keyword">for</span> <span class="token builtin class-name">command</span></code></pre>
  </figure>

  <figure class="terminal">
    <figcaption class="terminal">Basic Command with Loud Arg > 7

</figcaption>
    <pre><code class="language-bash">$ trv basic:arg <span class="token number">8</span>

HELLO</code></pre>
  </figure>

  <figure class="terminal">
    <figcaption class="terminal">Basic Command without Arg

</figcaption>
    <pre><code class="language-bash">$ trv basic:arg

Hello</code></pre>
  </figure>

Additionally, if you provide a field as an array, it will collect all valid values (excludes flags, and any arguments past a <code class="item input">--</code>).

  <figure class="code">
    <figcaption class="code">Basic Command with Arg List
<cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/cli/doc/cli.basic_arg-list.ts">Source</a></cite>

</figcaption>
    <pre><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> CliCommand <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/cli'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> Max<span class="token punctuation">,</span> Min <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/schema'</span><span class="token punctuation">;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">CliCommand</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">BasicCommand</span> <span class="token punctuation">{{'{'}}</span>

  reverse<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>

  <span class="token function">main</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Min</span></span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">Max</span></span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> volumes<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>volumes<span class="token punctuation">.</span><span class="token function">toSorted</span><span class="token punctuation">(</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>a <span class="token operator">-</span> b<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>reverse <span class="token operator">?</span> <span class="token operator">-</span><span class="token number">1</span> <span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span>
<span class="token punctuation">{{'}'}}</span></code></pre>
  </figure>

  <figure class="terminal">
    <figcaption class="terminal">Basic Command

</figcaption>
    <pre><code class="language-bash">$ trv basic:arg-list <span class="token parameter variable">-h</span>

Usage: basic:arg-list <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token operator">&lt;</span>volumes<span class="token punctuation">..</span>.:number<span class="token operator">></span>

Options:
  -r, <span class="token parameter variable">--reverse</span>
  -h, <span class="token parameter variable">--help</span>     display <span class="token builtin class-name">help</span> <span class="token keyword">for</span> <span class="token builtin class-name">command</span></code></pre>
  </figure>

  <figure class="terminal">
    <figcaption class="terminal">Basic Arg List

</figcaption>
    <pre><code class="language-bash">$ trv basic:arg-list <span class="token number">10</span> <span class="token number">5</span> <span class="token number">3</span> <span class="token number">9</span> <span class="token number">8</span> <span class="token number">1</span>

<span class="token number">1</span> <span class="token number">3</span> <span class="token number">5</span> <span class="token number">8</span> <span class="token number">9</span> <span class="token number">10</span></code></pre>
  </figure>

  <figure class="terminal">
    <figcaption class="terminal">Basic Arg List with Invalid Number

</figcaption>
    <pre><code class="language-bash">$ trv basic:arg-list <span class="token number">10</span> <span class="token number">5</span> <span class="token number">3</span> <span class="token number">9</span> <span class="token number">20</span> <span class="token number">1</span>

Execution failed:
 * Argument volumes<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span> is greater than <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>

Usage: basic:arg-list <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token operator">&lt;</span>volumes<span class="token punctuation">..</span>.:number<span class="token operator">></span>

Options:
  -r, <span class="token parameter variable">--reverse</span>
  -h, <span class="token parameter variable">--help</span>     display <span class="token builtin class-name">help</span> <span class="token keyword">for</span> <span class="token builtin class-name">command</span></code></pre>
  </figure>

  <figure class="terminal">
    <figcaption class="terminal">Basic Arg List with Reverse

</figcaption>
    <pre><code class="language-bash">$ trv basic:arg-list <span class="token parameter variable">-r</span> <span class="token number">10</span> <span class="token number">5</span> <span class="token number">3</span> <span class="token number">9</span> <span class="token number">8</span> <span class="token number">1</span>

<span class="token number">10</span> <span class="token number">9</span> <span class="token number">8</span> <span class="token number">5</span> <span class="token number">3</span> <span class="token number">1</span></code></pre>
  </figure>

<h2 id="customization">Customization</h2>

By default, all fields are treated as flags and all parameters of <code class="item method">main()</code> are treated as arguments within the validation process.  Like the standard <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/schema/src/decorator/schema.ts#L19">@Schema</a> behavior, we can leverage the metadata of the fields/parameters to help provide additional customization/context for the users of the commands.

  <figure class="code">
    <figcaption class="code">Custom Command with Metadata
<cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/cli/doc/cli.custom_arg.ts">Source</a></cite>

</figcaption>
    <pre><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> CliCommand <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/cli'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> Max<span class="token punctuation">,</span> Min <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/schema'</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Custom Argument Command
 */</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">CliCommand</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CustomCommand</span> <span class="token punctuation">{{'{'}}</span>

  <span class="token comment">/**
   * The message to send back to the user
   * @alias -m
   * @alias --message
   */</span>
  text<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">'hello'</span><span class="token punctuation">;</span>

  <span class="token function">main</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Min</span></span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">Max</span></span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> volume<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>volume <span class="token operator">></span> <span class="token number">7</span> <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">.</span>text<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span>
<span class="token punctuation">{{'}'}}</span></code></pre>
  </figure>

  <figure class="terminal">
    <figcaption class="terminal">Custom Command Help

</figcaption>
    <pre><code class="language-bash">$ trv custom:arg <span class="token parameter variable">-h</span>

Usage: custom:arg <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token punctuation">[</span>volume:number<span class="token punctuation">]</span>

Options:
  -m, <span class="token parameter variable">--message</span> <span class="token operator">&lt;</span>string<span class="token operator">></span>  The message to send back to the user <span class="token punctuation">(</span>default: <span class="token string">"hello"</span><span class="token punctuation">)</span>
  -h, <span class="token parameter variable">--help</span>              display <span class="token builtin class-name">help</span> <span class="token keyword">for</span> <span class="token builtin class-name">command</span></code></pre>
  </figure>

  <figure class="terminal">
    <figcaption class="terminal">Custom Command Help with overridden Text

</figcaption>
    <pre><code class="language-bash">$ trv custom:arg <span class="token number">10</span> <span class="token parameter variable">-m</span> cUsToM

CUSTOM</code></pre>
  </figure>

  <figure class="terminal">
    <figcaption class="terminal">Custom Command Help with default Text

</figcaption>
    <pre><code class="language-bash">$ trv custom:arg <span class="token number">6</span>

hello</code></pre>
  </figure>

<h2 id="environment-variable-support">Environment Variable Support</h2>

In addition to standard flag overriding (e.g. <code class="item input">/** @alias -m */</code>), the command execution also supports allowing environment variables to provide values (secondary to whatever is passed in on the command line).

  <figure class="code">
    <figcaption class="code">Custom Command with Env Var
<cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/cli/doc/cli.custom_env-arg.ts">Source</a></cite>

</figcaption>
    <pre><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> CliCommand <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/cli'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> Max<span class="token punctuation">,</span> Min <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/schema'</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Custom Argument Command
 */</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">CliCommand</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">CustomCommand</span> <span class="token punctuation">{{'{'}}</span>

  <span class="token comment">/**
   * The message to send back to the user
   * @alias env.MESSAGE
   */</span>
  text<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">=</span> <span class="token string">'hello'</span><span class="token punctuation">;</span>

  <span class="token function">main</span><span class="token punctuation">(</span><span class="token decorator"><span class="token at operator">@</span><span class="token function">Min</span></span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token decorator"><span class="token at operator">@</span><span class="token function">Max</span></span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span> volume<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>volume <span class="token operator">></span> <span class="token number">7</span> <span class="token operator">?</span> <span class="token keyword">this</span><span class="token punctuation">.</span>text<span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">this</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span>
<span class="token punctuation">{{'}'}}</span></code></pre>
  </figure>

  <figure class="terminal">
    <figcaption class="terminal">Custom Command Help

</figcaption>
    <pre><code class="language-bash">$ trv custom:env-arg <span class="token parameter variable">-h</span>

Usage: custom:env-arg <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token punctuation">[</span>volume:number<span class="token punctuation">]</span>

Options:
  -t, <span class="token parameter variable">--text</span> <span class="token operator">&lt;</span>string<span class="token operator">></span>  The message to send back to the user <span class="token punctuation">(</span>default: <span class="token string">"hello"</span><span class="token punctuation">)</span>
  -h, <span class="token parameter variable">--help</span>           display <span class="token builtin class-name">help</span> <span class="token keyword">for</span> <span class="token builtin class-name">command</span></code></pre>
  </figure>

  <figure class="terminal">
    <figcaption class="terminal">Custom Command Help with default Text

</figcaption>
    <pre><code class="language-bash">$ trv custom:env-arg <span class="token number">6</span>

hello</code></pre>
  </figure>

  <figure class="terminal">
    <figcaption class="terminal">Custom Command Help with overridden Text

</figcaption>
    <pre><code class="language-bash">$ <span class="token assign-left variable">MESSAGE</span><span class="token operator">=</span>CuStOm trv custom:env-arg <span class="token number">10</span>

CUSTOM</code></pre>
  </figure>

  <figure class="terminal">
    <figcaption class="terminal">Custom Command Help with overridden Text

</figcaption>
    <pre><code class="language-bash">$ <span class="token assign-left variable">MESSAGE</span><span class="token operator">=</span>CuStOm trv custom:env-arg <span class="token number">7</span>

CuStOm</code></pre>
  </figure>

<h2 id="flag-file-support">Flag File Support</h2>

Sometimes its also convenient, especially with commands that support a variety of flags, to provide easy access to pre-defined sets of flags.  Flag files represent a snapshot of command line arguments and flags, as defined in a file.  When referenced, these inputs are essentially injected into the command line as if the user had typed them manually.

  <figure class="code">
    <figcaption class="code">Example Flag File
<cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/cli/doc/base.flags">Source</a></cite>

</figcaption>
    <pre><code class="language-bash"><span class="token parameter variable">--host</span> localhost
<span class="token parameter variable">--port</span> <span class="token number">3306</span>
<span class="token parameter variable">--username</span> app</code></pre>
  </figure>

As you can see in this file, it provides easy access to predefine the host, port, and user flags.

  <figure class="code">
    <figcaption class="code">Using a Flag File

</figcaption>
    <pre><code class="language-bash">npx trv call:db <span class="token operator">+=</span>base <span class="token parameter variable">--password</span> <span class="token operator">&lt;</span>custom<span class="token operator">></span></code></pre>
  </figure>

The flag files can be included in one of a few ways:
<ul> <li><code class="item input">+=&lt;name&gt;</code> - This translates into <code class="item input">&lt;module&gt;/support/&lt;name&gt;.flags</code>, which is a convenient shorthand.</li>
<li><code class="item input">+=&lt;module&gt;/path/file.flags</code> - This is a path-related file that will be resolved from the module's location.</li>
<li><code class="item input">+=/path/file.flags</code> - This is an absolute path that will be read from the root of the file system.</li>
</ul>
Ultimately, after resolution, the content of these files will be injected inline within the location.

  <figure class="code">
    <figcaption class="code">Final arguments after Flag File resolution

</figcaption>
    <pre><code class="language-bash">npx trv call:db <span class="token parameter variable">--host</span> localhost <span class="token parameter variable">--port</span> <span class="token number">3306</span> <span class="token parameter variable">--username</span> app <span class="token parameter variable">--password</span> <span class="token operator">&lt;</span>custom<span class="token operator">></span></code></pre>
  </figure>

<h2 id="vscode-integration">VSCode Integration</h2>

By default, cli commands do not expose themselves to the VSCode extension, as the majority of them are not intended for that sort of operation.  <a class="module-link" href="https://github.com/travetto/travetto/tree/main/module/web" title="Declarative support for creating Web Applications">Web API</a> does expose a cli target <code class="item input">web:http</code> that will show up, to help run/debug a web application.  Any command can mark itself as being a run target, and will be eligible for running from within the <a target="_blank" class="external-link" href="https://marketplace.visualstudio.com/items?itemName=arcsine.travetto-plugin">VSCode plugin</a>. This is achieved by setting the <code class="item input">runTarget</code> field on the <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/cli/src/registry/decorator.ts#L98">@CliCommand</a> decorator.  This means the target will be visible within the editor tooling.

  <figure class="code">
    <figcaption class="code">Simple Run Target
<cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/cli/doc/cli.run_simple.ts">Source</a></cite>

</figcaption>
    <pre><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> CliCommand <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/cli'</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Simple Run Target
 */</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">CliCommand</span></span><span class="token punctuation">(</span><span class="token punctuation">{{'{'}}</span> runTarget<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">{{'}'}}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">RunCommand</span> <span class="token punctuation">{{'{'}}</span>

  <span class="token function">main</span><span class="token punctuation">(</span>name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span>
<span class="token punctuation">{{'}'}}</span></code></pre>
  </figure>

<h2 id="advanced-usage">Advanced Usage</h2>

  <figure class="code">
    <figcaption class="code">Anatomy of a Command
<cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/cli/src/types.ts#L35">Source</a></cite>

</figcaption>
    <pre><code class="language-typescript"><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">CliCommandShape<span class="token operator">&lt;</span><span class="token constant">T</span> <span class="token keyword">extends</span> <span class="token builtin">unknown</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">unknown</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span></span> <span class="token punctuation">{{'{'}}</span>
  <span class="token comment">/**
   * Parsed state
   */</span>
  _parsed<span class="token operator">?</span><span class="token operator">:</span> ParsedState<span class="token punctuation">;</span>
  <span class="token comment">/**
   * Config
   */</span>
  _cfg<span class="token operator">?</span><span class="token operator">:</span> CliCommandConfig<span class="token punctuation">;</span>
  <span class="token comment">/**
   * Action target of the command
   */</span>
  <span class="token function">main</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> OrProm<span class="token operator">&lt;</span><span class="token keyword">undefined</span> <span class="token operator">|</span> <span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Run before main runs
   */</span>
  preMain<span class="token operator">?</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> OrProm<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Extra help
   */</span>
  help<span class="token operator">?</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> OrProm<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Run before help is displayed
   */</span>
  preHelp<span class="token operator">?</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> OrProm<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Is the command active/eligible for usage
   */</span>
  isActive<span class="token operator">?</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">boolean</span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Run before binding occurs
   */</span>
  preBind<span class="token operator">?</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> OrProm<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Run before validation occurs
   */</span>
  preValidate<span class="token operator">?</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> OrProm<span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Validation method
   */</span>
  validate<span class="token operator">?</span><span class="token punctuation">(</span><span class="token operator">...</span>args<span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">)</span><span class="token operator">:</span> OrProm<span class="token operator">&lt;</span>CliValidationError <span class="token operator">|</span> CliValidationError<span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span></code></pre>
  </figure>

<h3 id="dependency-injection">Dependency Injection</h3>

If the goal is to run a more complex application, which may include depending on <a class="module-link" href="https://github.com/travetto/travetto/tree/main/module/di" title="Dependency registration/management and injection support.">Dependency Injection</a>, we can take a look at <a class="module-link" href="https://github.com/travetto/travetto/tree/main/module/web" title="Declarative support for creating Web Applications">Web API</a>'s target:

  <figure class="code">
    <figcaption class="code">Simple Run Target
<cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/web-http/support/cli.web_http.ts">Source</a></cite>

</figcaption>
    <pre><code class="language-typescript"><span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> Runtime<span class="token punctuation">,</span> toConcrete <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/runtime'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> DependencyRegistryIndex <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/di'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> CliCommand<span class="token punctuation">,</span> <span class="token keyword">type</span> <span class="token class-name">CliCommandShape</span> <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/cli'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> NetUtil <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/web'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> Registry <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/registry'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{{'{'}}</span> WebHttpServer <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'../src/types.ts'</span><span class="token punctuation">;</span>

<span class="token comment">/**
 * Run a web server
 */</span>
<span class="token decorator"><span class="token at operator">@</span><span class="token function">CliCommand</span></span><span class="token punctuation">(</span><span class="token punctuation">{{'{'}}</span> runTarget<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token keyword">with</span><span class="token operator">:</span> <span class="token punctuation">{{'{'}}</span> debugIpc<span class="token operator">:</span> <span class="token string">'optional'</span><span class="token punctuation">,</span> restartOnChange<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> module<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> profiles<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">{{'}'}}</span> <span class="token punctuation">{{'}'}}</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">WebHttpCommand</span> <span class="token keyword">implements</span> <span class="token class-name">CliCommandShape</span> <span class="token punctuation">{{'{'}}</span>

  <span class="token comment">/** Port to run on */</span>
  port<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>

  <span class="token comment">/** Kill conflicting port owner */</span>
  killConflict<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">boolean</span> <span class="token operator">=</span> Runtime<span class="token punctuation">.</span>localDevelopment<span class="token punctuation">;</span>

  <span class="token function">preMain</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{{'{'}}</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>port<span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
      process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">WEB_HTTP_PORT</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${{'{'}}</span><span class="token keyword">this</span><span class="token punctuation">.</span>port<span class="token interpolation-punctuation punctuation">{{'}'}}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
    <span class="token punctuation">{{'}'}}</span>
  <span class="token punctuation">{{'}'}}</span>

  <span class="token keyword">async</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span><span class="token keyword">void</span><span class="token operator">></span> <span class="token punctuation">{{'{'}}</span>
    <span class="token keyword">await</span> Registry<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> instance <span class="token operator">=</span> <span class="token keyword">await</span> DependencyRegistryIndex<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token generic-function"><span class="token function">toConcrete</span><span class="token generic class-name"><span class="token operator">&lt;</span>WebHttpServer<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">try</span> <span class="token punctuation">{{'{'}}</span>
      <span class="token keyword">const</span> handle <span class="token operator">=</span> <span class="token keyword">await</span> instance<span class="token punctuation">.</span><span class="token function">serve</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> handle<span class="token punctuation">.</span>complete<span class="token punctuation">;</span>
    <span class="token punctuation">{{'}'}}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
      <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>killConflict <span class="token operator">?</span> <span class="token keyword">await</span> NetUtil<span class="token punctuation">.</span><span class="token function">freePortOnConflict</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token operator">?.</span>processId<span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
        <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">warn</span><span class="token punctuation">(</span><span class="token string">'Killed process owning port'</span><span class="token punctuation">,</span> result<span class="token punctuation">)</span><span class="token punctuation">;</span>
        process<span class="token punctuation">.</span>exitCode <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span> <span class="token comment">// Indicate error, restart will use if in that mode</span>
        <span class="token keyword">return</span><span class="token punctuation">;</span>
      <span class="token punctuation">{{'}'}}</span>
      <span class="token keyword">throw</span> err<span class="token punctuation">;</span>
    <span class="token punctuation">{{'}'}}</span>
  <span class="token punctuation">{{'}'}}</span>
<span class="token punctuation">{{'}'}}</span></code></pre>
  </figure>

As noted in the example above, <code class="item input">fields</code> is specified in this execution, with support for <code class="item input">module</code>, and <code class="item input">env</code>. These env flag is directly tied to the <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/runtime/src/context.ts#L13">Runtime</a> <code class="item field">name</code> defined in the <a class="module-link" href="https://github.com/travetto/travetto/tree/main/module/runtime" title="Runtime for travetto applications.">Runtime</a> module. <br><br>
The <code class="item input">module</code> field is slightly more complex, but is geared towards supporting commands within a monorepo context.  This flag ensures that a module is specified if running from the root of the monorepo, and that the module provided is real, and can run the desired command.  When running from an explicit module folder in the monorepo, the module flag is ignored.

<h3 id="custom-validation">Custom Validation</h3>

In addition to dependency injection, the command contract also allows for a custom validation function, which will have access to bound command (flags, and args) as well as the unknown arguments. When a command implements this method, any <a target="_blank" class="source-link" href="https://github.com/travetto/travetto/tree/main/module/cli/src/types.ts#L20">CliValidationError</a> errors that are returned will be shared with the user, and fail to invoke the <code class="item method">main</code> method.

  <figure class="code">
    <figcaption class="code">CliValidationError
<cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/cli/src/types.ts#L20">Source</a></cite>

</figcaption>
    <pre><code class="language-typescript"><span class="token keyword">export</span> <span class="token keyword">interface</span> <span class="token class-name">CliValidationError</span> <span class="token punctuation">{{'{'}}</span>
  <span class="token comment">/**
   * The error message
   */</span>
  message<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  <span class="token comment">/**
   * Source of validation
   */</span>
  source<span class="token operator">?</span><span class="token operator">:</span> <span class="token string">'flag'</span> <span class="token operator">|</span> <span class="token string">'arg'</span> <span class="token operator">|</span> <span class="token string">'custom'</span><span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span><span class="token punctuation">;</span></code></pre>
  </figure>

A simple example of the validation can be found in the <code class="item input">doc</code> command:

  <figure class="code">
    <figcaption class="code">Simple Validation Example
<cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/doc/support/cli.doc.ts#L42">Source</a></cite>

</figcaption>
    <pre><code class="language-typescript"><span class="token keyword">async</span> <span class="token function">validate</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>CliValidationError <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token operator">></span> <span class="token punctuation">{{'{'}}</span>
  <span class="token keyword">const</span> docFile <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>input<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token keyword">await</span> fs<span class="token punctuation">.</span><span class="token function">stat</span><span class="token punctuation">(</span>docFile<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">catch</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
    <span class="token keyword">return</span> <span class="token punctuation">{{'{'}}</span> message<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">input: </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${{'{'}}</span><span class="token keyword">this</span><span class="token punctuation">.</span>input<span class="token interpolation-punctuation punctuation">{{'}'}}</span></span><span class="token string"> does not exist</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> source<span class="token operator">:</span> <span class="token string">'flag'</span> <span class="token punctuation">{{'}'}}</span><span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span>
<span class="token punctuation">{{'}'}}</span></code></pre>
  </figure>

<h2 id="cli-service">CLI - service</h2>

The module provides the ability to start/stop/restart services as <a target="_blank" class="external-link" href="https://www.docker.com/community-edition">docker</a> containers.  This is meant to be used for development purposes, to minimize the effort of getting an application up and running.  Services can be targeted individually or handled as a group.

  <figure class="terminal">
    <figcaption class="terminal">Command Service

</figcaption>
    <pre><code class="language-bash">$ trv <span class="token function">service</span> <span class="token parameter variable">--help</span>

Usage: <span class="token function">service</span> <span class="token punctuation">[</span>options<span class="token punctuation">]</span> <span class="token operator">&lt;</span>action:restart<span class="token operator">|</span>start<span class="token operator">|</span>status<span class="token operator">|</span>stop<span class="token operator">></span> <span class="token punctuation">[</span>services<span class="token punctuation">..</span>.:string<span class="token punctuation">]</span>

Options:
  -h, <span class="token parameter variable">--help</span>  display <span class="token builtin class-name">help</span> <span class="token keyword">for</span> <span class="token builtin class-name">command</span>

Available Services
--------------------
 * dynamodb@3.3.0
 * elasticsearch@9.2.4
 * firestore@latest
 * mongodb@8.2
 * mysql@9.6
 * postgresql@18.1
 * redis@8.4
 * s3@4.11.0</code></pre>
  </figure>

A sample of all services available to the entire framework:

  <figure class="terminal">
    <figcaption class="terminal">All Services

</figcaption>
    <pre><code class="language-bash">$ trv <span class="token function">service</span> status

Service          Version    Status
-------------------------------------------------
dynamodb           <span class="token number">3.3</span>.0    Running 93af422e793a
elasticsearch      <span class="token number">9.2</span>.4    Running ed76ee063d13
firestore         latest    Running feec2e5e95b4
mongodb              <span class="token number">8.2</span>    Running 5513eba6734e
mysql                <span class="token number">9.6</span>    Running 307bc66d442a
postgresql          <span class="token number">18.1</span>    Running e78291e71040
redis                <span class="token number">8.4</span>    Running 77ba279b4e30
s3                <span class="token number">4.11</span>.0    Running fdacfc55b9e3</code></pre>
  </figure>

<h3 id="defining-new-services">Defining new Services</h3>

The services are defined as plain typescript files within the framework and can easily be extended:

  <figure class="code">
    <figcaption class="code">Sample Service Definition
<cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/model-mongo/support/service.mongo.ts">Source</a></cite>

</figcaption>
    <pre><code class="language-typescript"><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{{'{'}}</span> ServiceDescriptor <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/cli'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> version <span class="token operator">=</span> process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">MONGO_VERSION</span> <span class="token operator">||</span> <span class="token string">'8.2'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> service<span class="token operator">:</span> ServiceDescriptor <span class="token operator">=</span> <span class="token punctuation">{{'{'}}</span>
  name<span class="token operator">:</span> <span class="token string">'mongodb'</span><span class="token punctuation">,</span>
  version<span class="token punctuation">,</span>
  port<span class="token operator">:</span> <span class="token number">27017</span><span class="token punctuation">,</span>
  image<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">mongo:</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${{'{'}}</span>version<span class="token interpolation-punctuation punctuation">{{'}'}}</span></span><span class="token template-punctuation string">`</span></span>
<span class="token punctuation">{{'}'}}</span><span class="token punctuation">;</span></code></pre>
  </figure>
