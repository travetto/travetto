<!-- This file was generated by @travetto/doc and should not be modified directly -->
<!-- Please modify https://github.com/travetto/travetto/tree/main/module/eslint/DOC.tsx and execute "npx trv doc" to rebuild -->
<h1>ES Linting Rules
<small>ES Linting Rules</small>
</h1>

  <figure class="install">
    <figcaption class="install">Install @travetto/eslint
    
    </figcaption>
    <pre><code class="language-bash"><span class="token function">npm</span> <span class="token function">install</span> @travetto/eslint

<span class="token comment"># or</span>

<span class="token function">yarn</span> <span class="token function">add</span> @travetto/eslint</code></pre>
  </figure>

<a target="_blank" class="external-link" href="https://eslint.org/">ESLint</a> is the standard for linting <a target="_blank" class="external-link" href="https://typescriptlang.org">Typescript</a> and <a target="_blank" class="external-link" href="https://developer.mozilla.org/en-US/docs/Web/JavaScript">Javascript</a> code.  This module provides some standard linting patterns and the ability to create custom rules. Due to the fact that the framework supports both <a target="_blank" class="external-link" href="https://nodejs.org/api/modules.html">CommonJS</a> and <a target="_blank" class="external-link" href="https://nodejs.org/api/esm.html">Ecmascript Module</a> formats, a novel solution was required to allow <a target="_blank" class="external-link" href="https://eslint.org/">ESLint</a> to load <a target="_blank" class="external-link" href="https://nodejs.org/api/esm.html">Ecmascript Module</a> files.

<p class="note"><strong>Note</strong> The <a target="_blank" class="external-link" href="https://eslint.org/">ESLint</a> has introduced <a target="_blank" class="source-link" href="https://eslint.org/blog/2022/08/new-config-system-part-3/">a new configuration format</a> which allows for <a target="_blank" class="external-link" href="https://nodejs.org/api/esm.html">Ecmascript Module</a> files.</p>

<h2 id="cli-register">CLI - Register</h2>

In a new project, the first thing that will need to be done, post installation, is to create the eslint configuration file.

  <figure class="terminal">
    <figcaption class="terminal">Registering the Configuration

</figcaption>
    <pre><code class="language-bash">$ trv lint:register

Wrote eslint config to <span class="token operator">&lt;</span>workspace-root<span class="token operator">></span>/eslint.config.js</code></pre>
  </figure>

This is the file the linter will use, and any other tooling (e.g. IDEs).

  <figure class="code">
    <figcaption class="code">Sample configuration
<cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/eslint.config.js">Source</a></cite>

</figcaption>
    <pre><code class="language-javascript">process<span class="token punctuation">.</span>env<span class="token punctuation">.</span><span class="token constant">TRV_MANIFEST</span> <span class="token operator">=</span> <span class="token string">'./.trv/output/node_modules/@travetto/eslint'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token punctuation">{{'{'}}</span> buildConfig <span class="token punctuation">{{'}'}}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./.trv/output/node_modules/@travetto/eslint/support/bin/eslint-config.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token punctuation">{{'{'}}</span> RuntimeIndex <span class="token punctuation">{{'}'}}</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./.trv/output/node_modules/@travetto/runtime/__index__.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> pluginFiles <span class="token operator">=</span> RuntimeIndex<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token punctuation">{{'{'}}</span> <span class="token function-variable function">folder</span><span class="token operator">:</span> <span class="token parameter">f</span> <span class="token operator">=></span> f <span class="token operator">===</span> <span class="token string">'support'</span><span class="token punctuation">,</span> <span class="token function-variable function">file</span><span class="token operator">:</span> <span class="token parameter">f</span> <span class="token operator">=></span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">support\/eslint[.]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span> <span class="token punctuation">{{'}'}}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> plugins <span class="token operator">=</span> pluginFiles<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token parameter">x</span> <span class="token operator">=></span> <span class="token function">require</span><span class="token punctuation">(</span>x<span class="token punctuation">.</span>outputFile<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token function">buildConfig</span><span class="token punctuation">(</span>plugins<span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> config<span class="token punctuation">;</span></code></pre>
  </figure>

The output is tied to whether or not you are using the <a target="_blank" class="external-link" href="https://nodejs.org/api/modules.html">CommonJS</a> or <a target="_blank" class="external-link" href="https://nodejs.org/api/esm.html">Ecmascript Module</a> format.

<h2 id="cli-lint">CLI - Lint</h2>

Once installed, using the linter is as simple as invoking it via the cli:

  <figure class="terminal">
    <figcaption class="terminal">Running the Linter

</figcaption>
    <pre><code class="language-bash">npx trv lint</code></pre>
  </figure>

Or pointing your IDE to reference the registered configuration file.

<h2 id="custom-rules">Custom Rules</h2>

It can be seen in the sample configuration, that the configuration is looking for files with the pattern of <code class="item path">support/eslint/.*</code> <br><br>
These files will follow a given pattern of:

  <figure class="code">
    <figcaption class="code">Custom Rule Shape
<cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/module/eslint/support/bin/types.ts#L1">Source</a></cite>

</figcaption>
    <pre><code class="language-typescript"><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token class-name">eslint</span> <span class="token keyword">from</span> <span class="token string">'eslint'</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">TrvEslintPlugin</span> <span class="token operator">=</span> <span class="token punctuation">{{'{'}}</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  rules<span class="token operator">:</span> Record<span class="token operator">&lt;</span><span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token punctuation">{{'{'}}</span>
    defaultLevel<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token builtin">boolean</span> <span class="token operator">|</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
    <span class="token function">create</span><span class="token punctuation">(</span>context<span class="token operator">:</span> eslint<span class="token punctuation">.</span>Rule<span class="token punctuation">.</span>RuleContext<span class="token punctuation">)</span><span class="token operator">:</span> eslint<span class="token punctuation">.</span>Rule<span class="token punctuation">.</span>RuleListener<span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span><span class="token operator">></span><span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span><span class="token punctuation">;</span></code></pre>
  </figure>

An example plugin is used in the <a target="_blank" class="external-link" href="https://travetto.dev">Travetto</a> framework for enforcing import patterns:

  <figure class="code">
    <figcaption class="code">Import Order Rule
<cite><a target="_blank" href="https://github.com/travetto/travetto/tree/main/support/eslint.import-order.ts#L1">Source</a></cite>

</figcaption>
    <pre><code class="language-typescript"><span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token class-name">eslint</span> <span class="token keyword">from</span> <span class="token string">'eslint'</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{{'{'}}</span> Program<span class="token punctuation">,</span> BaseExpression<span class="token punctuation">,</span> Expression <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'estree'</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> <span class="token keyword">type</span> <span class="token punctuation">{{'{'}}</span> TrvEslintPlugin <span class="token punctuation">{{'}'}}</span> <span class="token keyword">from</span> <span class="token string">'@travetto/eslint'</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> groupTypeMap <span class="token operator">=</span> <span class="token punctuation">{{'{'}}</span>
  node<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'node'</span><span class="token punctuation">,</span> <span class="token string">'travetto'</span><span class="token punctuation">,</span> <span class="token string">'workspace'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  travetto<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'travetto'</span><span class="token punctuation">,</span> <span class="token string">'workspace'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  workspace<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'workspace'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">{{'}'}}</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">TSAsExpression</span> <span class="token keyword">extends</span> <span class="token class-name">BaseExpression</span> <span class="token punctuation">{{'{'}}</span>
  type<span class="token operator">:</span> <span class="token string">'TSAsExpression'</span><span class="token punctuation">;</span>
  expression<span class="token operator">:</span> Expression<span class="token punctuation">;</span>
<span class="token punctuation">{{'}'}}</span>

<span class="token keyword">declare</span> <span class="token keyword">module</span> <span class="token string">'estree'</span> <span class="token punctuation">{{'{'}}</span>
  <span class="token keyword">interface</span> <span class="token class-name">ExpressionMap</span> <span class="token punctuation">{{'{'}}</span>
    TSAsExpression<span class="token operator">:</span> TSAsExpression<span class="token punctuation">;</span>
  <span class="token punctuation">{{'}'}}</span>
<span class="token punctuation">{{'}'}}</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> ImportOrder<span class="token operator">:</span> TrvEslintPlugin <span class="token operator">=</span> <span class="token punctuation">{{'{'}}</span>
  name<span class="token operator">:</span> <span class="token string">'@travetto-import'</span><span class="token punctuation">,</span>
  rules<span class="token operator">:</span> <span class="token punctuation">{{'{'}}</span>
    order<span class="token operator">:</span> <span class="token punctuation">{{'{'}}</span>
      defaultLevel<span class="token operator">:</span> <span class="token string">'error'</span><span class="token punctuation">,</span>
      <span class="token function">create</span><span class="token punctuation">(</span>context<span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
        <span class="token keyword">function</span> <span class="token function">check</span><span class="token punctuation">(</span><span class="token punctuation">{{'{'}}</span> body <span class="token punctuation">{{'}'}}</span><span class="token operator">:</span> Program<span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">{{'{'}}</span>
          <span class="token keyword">let</span> groupType<span class="token operator">:</span> <span class="token punctuation">(</span><span class="token keyword">keyof</span> <span class="token keyword">typeof</span> groupTypeMap<span class="token punctuation">)</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
          <span class="token keyword">let</span> groupSize <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
          <span class="token keyword">let</span> contiguous <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
          <span class="token keyword">let</span> prev<span class="token operator">:</span> eslint<span class="token punctuation">.</span><span class="token constant">AST</span><span class="token punctuation">.</span>Program<span class="token punctuation">[</span><span class="token string">'body'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token builtin">number</span><span class="token punctuation">]</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>

          <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> node <span class="token keyword">of</span> body<span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>

            <span class="token keyword">let</span> from<span class="token operator">:</span> <span class="token builtin">string</span> <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'ImportDeclaration'</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>source<span class="token operator">?.</span>value <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> node<span class="token punctuation">.</span>source<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
                from <span class="token operator">=</span> node<span class="token punctuation">.</span>source<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
              <span class="token punctuation">{{'}'}}</span>
            <span class="token punctuation">{{'}'}}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>node<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'VariableDeclaration'</span> <span class="token operator">&amp;&amp;</span> node<span class="token punctuation">.</span>kind <span class="token operator">===</span> <span class="token string">'const'</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
              <span class="token keyword">const</span> <span class="token punctuation">[</span>decl<span class="token punctuation">]</span> <span class="token operator">=</span> node<span class="token punctuation">.</span>declarations<span class="token punctuation">;</span>
              <span class="token keyword">let</span> call<span class="token operator">:</span> Expression <span class="token operator">|</span> <span class="token keyword">undefined</span><span class="token punctuation">;</span>
              <span class="token keyword">const</span> initType <span class="token operator">=</span> decl<span class="token operator">?.</span>init<span class="token operator">?.</span>type<span class="token punctuation">;</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span>initType <span class="token operator">===</span> <span class="token string">'CallExpression'</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
                call <span class="token operator">=</span> decl<span class="token punctuation">.</span>init<span class="token punctuation">;</span>
              <span class="token punctuation">{{'}'}}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>initType <span class="token operator">===</span> <span class="token string">'TSAsExpression'</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span> <span class="token comment">// tslint support</span>
                call <span class="token operator">=</span> decl<span class="token punctuation">.</span>init<span class="token punctuation">.</span>expression<span class="token punctuation">;</span>
              <span class="token punctuation">{{'}'}}</span>
              <span class="token keyword">if</span> <span class="token punctuation">(</span>
                call<span class="token operator">?.</span>type <span class="token operator">===</span> <span class="token string">'CallExpression'</span> <span class="token operator">&amp;&amp;</span> call<span class="token punctuation">.</span>callee<span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'Identifier'</span> <span class="token operator">&amp;&amp;</span>
                call<span class="token punctuation">.</span>callee<span class="token punctuation">.</span>name <span class="token operator">===</span> <span class="token string">'require'</span> <span class="token operator">&amp;&amp;</span> call<span class="token punctuation">.</span>arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>type <span class="token operator">===</span> <span class="token string">'Literal'</span>
              <span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
                <span class="token keyword">const</span> arg1 <span class="token operator">=</span> call<span class="token punctuation">.</span>arguments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>arg1<span class="token punctuation">.</span>value <span class="token operator">&amp;&amp;</span> <span class="token keyword">typeof</span> arg1<span class="token punctuation">.</span>value <span class="token operator">===</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
                  from <span class="token operator">=</span> arg1<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
                <span class="token punctuation">{{'}'}}</span>
              <span class="token punctuation">{{'}'}}</span>
            <span class="token punctuation">{{'}'}}</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>from<span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
              <span class="token keyword">continue</span><span class="token punctuation">;</span>
            <span class="token punctuation">{{'}'}}</span>

            <span class="token keyword">const</span> lineType<span class="token operator">:</span> <span class="token keyword">typeof</span> groupType <span class="token operator">=</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^@travetto</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">'travetto'</span> <span class="token operator">:</span> <span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">^[^.]</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>from<span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">'node'</span> <span class="token operator">:</span> <span class="token string">'workspace'</span><span class="token punctuation">;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">module\/[^/]+\/doc\/</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">.</span><span class="token function">test</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span><span class="token function">getFilename</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> lineType <span class="token operator">===</span> <span class="token string">'workspace'</span> <span class="token operator">&amp;&amp;</span> from<span class="token punctuation">.</span><span class="token function">startsWith</span><span class="token punctuation">(</span><span class="token string">'..'</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
              context<span class="token punctuation">.</span><span class="token function">report</span><span class="token punctuation">(</span><span class="token punctuation">{{'{'}}</span> message<span class="token operator">:</span> <span class="token string">'Doc does not support parent imports'</span><span class="token punctuation">,</span> node <span class="token punctuation">{{'}'}}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">{{'}'}}</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>groupType <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>groupTypeMap<span class="token punctuation">[</span>groupType<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">includes</span><span class="token punctuation">(</span>lineType<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
              context<span class="token punctuation">.</span><span class="token function">report</span><span class="token punctuation">(</span><span class="token punctuation">{{'{'}}</span> message<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Invalid transition from </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${{'{'}}</span>groupType<span class="token interpolation-punctuation punctuation">{{'}'}}</span></span><span class="token string"> to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${{'{'}}</span>lineType<span class="token interpolation-punctuation punctuation">{{'}'}}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> node <span class="token punctuation">{{'}'}}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">{{'}'}}</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>groupType <span class="token operator">===</span> lineType<span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
              groupSize <span class="token operator">+=</span> <span class="token number">1</span><span class="token punctuation">;</span>
            <span class="token punctuation">{{'}'}}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>node<span class="token punctuation">.</span>loc<span class="token operator">?.</span>end<span class="token punctuation">.</span>line <span class="token operator">??</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token punctuation">(</span>prev<span class="token operator">?.</span>loc<span class="token operator">?.</span>end<span class="token punctuation">.</span>line <span class="token operator">??</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span>
              <span class="token comment">// Newlines</span>
              contiguous <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
              groupSize <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
            <span class="token punctuation">{{'}'}}</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span>groupSize <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span> <span class="token comment">// New group, who dis</span>
              groupSize <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
              groupType <span class="token operator">=</span> lineType<span class="token punctuation">;</span>
            <span class="token punctuation">{{'}'}}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>groupType <span class="token operator">===</span> lineType <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span>contiguous<span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span> <span class="token comment">// Contiguous same</span>
              <span class="token comment">// Do nothing</span>
            <span class="token punctuation">{{'}'}}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>groupSize <span class="token operator">===</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{{'{'}}</span> <span class="token comment">// Contiguous diff, count 1</span>
              contiguous <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
              groupType <span class="token operator">=</span> lineType<span class="token punctuation">;</span>
            <span class="token punctuation">{{'}'}}</span> <span class="token keyword">else</span> <span class="token punctuation">{{'{'}}</span> <span class="token comment">// Contiguous diff, count > 1</span>
              context<span class="token punctuation">.</span><span class="token function">report</span><span class="token punctuation">(</span><span class="token punctuation">{{'{'}}</span> message<span class="token operator">:</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Invalid contiguous groups </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${{'{'}}</span>groupType<span class="token interpolation-punctuation punctuation">{{'}'}}</span></span><span class="token string"> and </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${{'{'}}</span>lineType<span class="token interpolation-punctuation punctuation">{{'}'}}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">,</span> node <span class="token punctuation">{{'}'}}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">{{'}'}}</span>
            prev <span class="token operator">=</span> node<span class="token punctuation">;</span>
          <span class="token punctuation">{{'}'}}</span>
        <span class="token punctuation">{{'}'}}</span>
        <span class="token keyword">return</span> <span class="token punctuation">{{'{'}}</span> Program<span class="token operator">:</span> check <span class="token punctuation">{{'}'}}</span><span class="token punctuation">;</span>
      <span class="token punctuation">{{'}'}}</span>
    <span class="token punctuation">{{'}'}}</span>
  <span class="token punctuation">{{'}'}}</span>
<span class="token punctuation">{{'}'}}</span><span class="token punctuation">;</span></code></pre>
  </figure>
