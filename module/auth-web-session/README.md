<!-- This file was generated by @travetto/doc and should not be modified directly -->
<!-- Please modify https://github.com/travetto/travetto/tree/main/module/auth-web-session/DOC.tsx and execute "npx trv doc" to rebuild -->
# Web Auth Session

## Web authentication session integration support for the Travetto framework

**Install: @travetto/auth-web-session**
```bash
npm install @travetto/auth-web-session

# or

yarn add @travetto/auth-web-session
```

One of [Web Auth](https://github.com/travetto/travetto/tree/main/module/auth-web#readme "Web authentication integration support for the Travetto framework")'s main responsibilities is being able to send and receive authentication/authorization information from the client. 

This module's responsibility is, to expose [Auth Session](https://github.com/travetto/travetto/tree/main/module/auth-session#readme "Session provider for the travetto auth module.")'s data, within the scope of the request/response flow.

**Code: Anatomy of the Session Interceptor**
```typescript
class WebSessionConfig { }

/**
 * Loads session, and provides ability to create session as needed, persists when complete.
 */
@Injectable()
export class AuthSessionInterceptor implements WebInterceptor {

  category: WebInterceptorCategory = 'application';
  dependsOn = [AuthContextInterceptor];

  @Inject()
  service: SessionService;

  @Inject()
  context: SessionContext;

  @Inject()
  config: WebSessionConfig;

  @Inject()
  webAsyncContext: WebAsyncContext;

  postConstruct(): void {
    this.webAsyncContext.registerType(toConcrete<Session>(), () => this.context.get(true));
    this.webAsyncContext.registerType(toConcrete<SessionData>(), () => this.context.get(true).data);
  }

  async filter({ next }: WebChainedContext): Promise<WebResponse> {
    try {
      await this.service.load();
      return await next();
    } finally {
      await this.service.persist();
    }
  }
}
```

Once operating within the [Session](https://github.com/travetto/travetto/tree/main/module/auth-session/src/session.ts#L6) boundaries, the session state can be injected via params, or accessed via the [SessionService](https://github.com/travetto/travetto/tree/main/module/auth-session/src/service.ts#L14).

**Code: Sample Usage**
```typescript
@Authenticated()
@Controller('/session')
export class SessionEndpoints {

  @Inject()
  session: SessionContext;

  @ContextParam()
  data: SessionData;

  @Put('/info')
  async storeInfo() {
    if (this.data) {
      this.data.age = 20;
      this.data.name = 'Roger'; // Setting data
    }
  }

  @Get('/logout')
  async logout() {
    await this.session.destroy();
  }

  @Get('/info/age')
  async getInfo() {
    const { data } = this.session.get(true);
    return data?.age;
  }
}
```
