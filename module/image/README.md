<!-- This file was generated by @travetto/doc and should not be modified directly -->
<!-- Please modify https://github.com/travetto/travetto/tree/main/module/image/DOC.tsx and execute "npx trv doc" to rebuild -->
# Image

## Image support, resizing, and optimization

**Install: @travetto/image**
```bash
npm install @travetto/image

# or

yarn add @travetto/image
```

This module provides functionality for image resizing, and png optimization. This is primarily meant to be used in conjunction with other modules, like the [Asset](https://github.com/travetto/travetto/tree/main/module/asset#readme "Modular library for storing and retrieving binary assets") module or the [Email Compilation Support](https://github.com/travetto/travetto/tree/main/module/email-compiler#readme "Email compiling module") module. It can also be invoked directly as needed (as it can be very handy for batch processing images on the command line). 

The utility's primary structure revolves around the [CommandOperation](https://github.com/travetto/travetto/tree/main/module/command/src/command.ts#L12) from the [Command](https://github.com/travetto/travetto/tree/main/module/command#readme "Support for executing complex commands at runtime.") module.  The [CommandOperation](https://github.com/travetto/travetto/tree/main/module/command/src/command.ts#L12)  allows for declaration of a local executable, and a fall-back docker container (mainly meant for development).  The [ImageConverter](https://github.com/travetto/travetto/tree/main/module/image/src/convert.ts#L37) utilizes [ImageMagick](https://imagemagick.org/index.php), [pngquant](https://pngquant.org/), and  [Jpegoptim](https://github.com/tjko/jpegoptim) as the backing for image resizing and png compression, respectively.

**Code: Simple Image Resize**
```typescript
import { createReadStream, createWriteStream } from 'node:fs';
import { pipeline } from 'node:stream/promises';

import { ImageConverter } from '@travetto/image';

export class ResizeService {
  async resizeImage(imgPath: string, width: number, height: number): Promise<string> {
    const stream = await ImageConverter.resize(createReadStream(imgPath), { w: width, h: height });
    const out = imgPath.replace(/[.][^.]+$/, (ext) => `.resized${ext}`);
    await pipeline(stream, createWriteStream(out));
    return out;
  }
}
```
